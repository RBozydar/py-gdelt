
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python client library for GDELT (Global Database of Events, Language, and Tone)">
      
      
        <meta name="author" content="Robert Wasilewski">
      
      
        <link rel="canonical" href="https://rbozydar.github.io/py-gdelt/api/endpoints/">
      
      
        <link rel="prev" href="../client/">
      
      
        <link rel="next" href="../filters/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Endpoints - gdelt-py</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#endpoints-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="gdelt-py" class="md-header__button md-logo" aria-label="gdelt-py" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gdelt-py
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Endpoints
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/RBozydar/py-gdelt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rbozydar/py-gdelt
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../architecture/" class="md-tabs__link">
        
  
  
    
  
  Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../user-guide/events/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../client/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="gdelt-py" class="md-nav__button md-logo" aria-label="gdelt-py" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gdelt-py
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RBozydar/py-gdelt" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rbozydar/py-gdelt
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/data-sources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Sources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events & Mentions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/gkg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GKG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/ngrams/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NGrams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/rest-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    REST APIs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/lookups/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lookups
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deduplication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deduplication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Error Handling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Endpoints
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Endpoints
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-based-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        File-Based Endpoints
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-Based Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EventsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mentionsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        MentionsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        MentionsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MentionsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkgendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GKGEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GKGEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GKGEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query_sync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query_sync--synchronous-usage-no-asyncawait-needed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Synchronous usage (no async/await needed)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stream_sync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync--synchronous-streaming-no-asyncawait-needed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Synchronous streaming (no async/await needed)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ngramsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        NGramsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        NGramsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NGramsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        close
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aenter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.__aexit__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aexit__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rest-api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        REST API Endpoints
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST API Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        DocEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        DocEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DocEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        timeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeoEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeoEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeoEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_geojson
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contextendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContextEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aenter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        analyze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.get_themes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_themes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.get_entities" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_entities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tvendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TVEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.query_clips" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_clips
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        timeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.station_chart" class="md-nav__link">
    <span class="md-ellipsis">
      
        station_chart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tvaiendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVAIEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVAIEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVAIEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TVAIEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVAIEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-based-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        File-Based Endpoints
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File-Based Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eventsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        EventsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EventsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.events.EventsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mentionsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        MentionsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        MentionsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MentionsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.mentions.MentionsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gkgendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GKGEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GKGEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GKGEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="query_sync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.query_sync--synchronous-usage-no-asyncawait-needed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Synchronous usage (no async/await needed)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="stream_sync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync--synchronous-streaming-no-asyncawait-needed" class="md-nav__link">
    <span class="md-ellipsis">
      
        Synchronous streaming (no async/await needed)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ngramsendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        NGramsEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        NGramsEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NGramsEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.close" class="md-nav__link">
    <span class="md-ellipsis">
      
        close
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aenter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.__aexit__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aexit__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.stream" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.query_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_sync
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.ngrams.NGramsEndpoint.stream_sync" class="md-nav__link">
    <span class="md-ellipsis">
      
        stream_sync
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rest-api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        REST API Endpoints
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="REST API Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        DocEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        DocEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DocEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.doc.DocEndpoint.timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        timeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geoendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeoEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        GeoEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeoEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.query" class="md-nav__link">
    <span class="md-ellipsis">
      
        query
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.geo.GeoEndpoint.to_geojson" class="md-nav__link">
    <span class="md-ellipsis">
      
        to_geojson
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contextendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContextEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.__aenter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __aenter__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.analyze" class="md-nav__link">
    <span class="md-ellipsis">
      
        analyze
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.get_themes" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_themes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.context.ContextEndpoint.get_entities" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_entities
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tvendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TVEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.query_clips" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_clips
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        timeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVEndpoint.station_chart" class="md-nav__link">
    <span class="md-ellipsis">
      
        station_chart
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tvaiendpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVAIEndpoint
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVAIEndpoint" class="md-nav__link">
    <span class="md-ellipsis">
      
        TVAIEndpoint
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TVAIEndpoint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#py_gdelt.endpoints.tv.TVAIEndpoint.search" class="md-nav__link">
    <span class="md-ellipsis">
      
        search
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="endpoints-api">Endpoints API</h1>
<h2 id="file-based-endpoints">File-Based Endpoints</h2>
<h3 id="eventsendpoint">EventsEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.events.EventsEndpoint" class="doc doc-heading">
            <code>EventsEndpoint</code>


</h3>


    <div class="doc doc-contents first">



        <p>Endpoint for querying GDELT Events data.</p>
<p>This endpoint orchestrates querying GDELT Events data from multiple sources
(files and BigQuery) using a DataFetcher. It handles:
- Source selection and fallback logic
- Type conversion from internal _RawEvent to public Event models
- Optional deduplication
- Both streaming and batch query modes</p>
<p>The endpoint uses dependency injection to receive source instances, making
it easy to test and configure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.files.FileSource">FileSource</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FileSource instance for downloading GDELT files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bigquery_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.bigquery.BigQuerySource">BigQuerySource</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional BigQuerySource instance for fallback queries</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fallback_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fallback to BigQuery on errors (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>BigQuery fallback only activates if both fallback_enabled=True AND
bigquery_source is provided AND credentials are configured.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from py_gdelt.sources import FileSource
from py_gdelt.filters import DateRange, EventFilter
from datetime import date</p>
<p>async with FileSource() as file_source:
...     endpoint = EventsEndpoint(file_source=file_source)
...     filter_obj = EventFilter(
...         date_range=DateRange(start=date(2024, 1, 1)),
...         actor1_country="USA",
...     )
...     # Batch query
...     result = await endpoint.query(filter_obj, deduplicate=True)
...     for event in result:
...         print(event.global_event_id)
...     # Streaming query
...     async for event in endpoint.stream(filter_obj):
...         process(event)</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/events.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="k">class</span><span class="w"> </span><span class="nc">EventsEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint for querying GDELT Events data.</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    This endpoint orchestrates querying GDELT Events data from multiple sources</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">    (files and BigQuery) using a DataFetcher. It handles:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">    - Source selection and fallback logic</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    - Type conversion from internal _RawEvent to public Event models</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    - Optional deduplication</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    - Both streaming and batch query modes</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    The endpoint uses dependency injection to receive source instances, making</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    it easy to test and configure.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        file_source: FileSource instance for downloading GDELT files</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        bigquery_source: Optional BigQuerySource instance for fallback queries</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        fallback_enabled: Whether to fallback to BigQuery on errors (default: True)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        BigQuery fallback only activates if both fallback_enabled=True AND</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        bigquery_source is provided AND credentials are configured.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.sources import FileSource</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import DateRange, EventFilter</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        &gt;&gt;&gt; async with FileSource() as file_source:</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        ...     endpoint = EventsEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        ...     filter_obj = EventFilter(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        ...         date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        ...         actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        ...     # Batch query</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        ...     result = await endpoint.query(filter_obj, deduplicate=True)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">        ...     for event in result:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        ...         print(event.global_event_id)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        ...     # Streaming query</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        ...     async for event in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">        ...         process(event)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">file_source</span><span class="p">:</span> <span class="n">FileSource</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">bigquery_source</span><span class="p">:</span> <span class="n">BigQuerySource</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">fallback_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="c1"># Import DataFetcher here to avoid circular imports</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.sources.fetcher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFetcher</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="p">:</span> <span class="n">DataFetcher</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">file_source</span><span class="o">=</span><span class="n">file_source</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">bigquery_source</span><span class="o">=</span><span class="n">bigquery_source</span><span class="p">,</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">fallback_enabled</span><span class="o">=</span><span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="s2">&quot;EventsEndpoint initialized (fallback_enabled=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query GDELT Events with automatic fallback.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        This is a batch query method that materializes all results into memory.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        For large datasets, prefer stream() for memory-efficient iteration.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            FetchResult containing Event instances. Use .data to access the list,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">            .failed to see any failed requests, and .complete to check if all</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            requests succeeded.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            &gt;&gt;&gt; result = await endpoint.query(filter_obj, deduplicate=True)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Found {len(result)} unique events&quot;)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            &gt;&gt;&gt; for event in result:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            ...     print(event.global_event_id)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="c1"># Default dedupe strategy</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">dedupe_strategy</span> <span class="o">=</span> <span class="n">DedupeStrategy</span><span class="o">.</span><span class="n">URL_DATE_LOCATION</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="c1"># Fetch raw events first (for deduplication)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">raw_events_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_RawEvent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="n">raw_event</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="k">async</span> <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="p">]</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fetched </span><span class="si">%d</span><span class="s2"> raw events from sources&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">))</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="c1"># Apply deduplication on raw events if requested</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="c1"># Deduplication happens on _RawEvent which implements HasDedupeFields protocol</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">original_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="c1"># Convert to iterator, deduplicate, then back to list</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">raw_events_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">apply_dedup</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">),</span> <span class="n">dedupe_strategy</span><span class="p">))</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                <span class="s2">&quot;Deduplicated </span><span class="si">%d</span><span class="s2"> events to </span><span class="si">%d</span><span class="s2"> unique (strategy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="n">original_count</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="c1"># Convert _RawEvent to Event models after deduplication</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">events</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="n">raw_events_list</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_event</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Converted </span><span class="si">%d</span><span class="s2"> events to Event models&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">))</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># Return as FetchResult (no failed requests tracked yet)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">events</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream GDELT Events with memory-efficient iteration.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        This is a streaming method that yields events one at a time, making it</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        suitable for large datasets. Memory usage is constant regardless of</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        result size.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            Event: Individual Event instances matching the filter</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            &gt;&gt;&gt; count = 0</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            &gt;&gt;&gt; async for event in endpoint.stream(filter_obj, deduplicate=True):</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            ...     print(event.global_event_id)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            ...     count += 1</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Streamed {count} unique events&quot;)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="c1"># Default dedupe strategy</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">dedupe_strategy</span> <span class="o">=</span> <span class="n">DedupeStrategy</span><span class="o">.</span><span class="n">URL_DATE_LOCATION</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="c1"># Fetch raw events from DataFetcher</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">raw_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="c1"># Apply deduplication if requested</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Applying deduplication (strategy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">raw_events</span> <span class="o">=</span> <span class="n">apply_dedup_async</span><span class="p">(</span><span class="n">raw_events</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="c1"># Convert _RawEvent to Event at yield boundary</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="n">raw_events</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_event</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Streamed </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>        <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        This is a convenience method that runs the async query() method</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        in a new event loop. Prefer using the async version when possible.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            FetchResult containing Event instances</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            &gt;&gt;&gt; for event in result:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            ...     print(event.global_event_id)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>                <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>                <span class="n">deduplicate</span><span class="o">=</span><span class="n">deduplicate</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>                <span class="n">dedupe_strategy</span><span class="o">=</span><span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>            <span class="p">),</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="p">)</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        It internally manages the event loop and yields events one at a time,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        providing true streaming behavior with memory efficiency.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            Iterator that yields Event instances for each matching event</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            &gt;&gt;&gt; for event in endpoint.stream_sync(filter_obj, deduplicate=True):</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            ...     print(event.global_event_id)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>                <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="n">deduplicate</span><span class="o">=</span><span class="n">deduplicate</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="n">dedupe_strategy</span><span class="o">=</span><span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="p">):</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                    <span class="n">event</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                    <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>                <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                    <span class="k">break</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build URL for events endpoint.</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Note: Events endpoint doesn&#39;t use URLs since it fetches from files/BigQuery.</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        This method is provided for compatibility with BaseEndpoint pattern but</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        is not used in practice.</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            **kwargs: Unused, but kept for interface consistency.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            Empty string (not used for file/BigQuery sources).</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.events.EventsEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deduplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query GDELT Events with automatic fallback.</p>
<p>This is a batch query method that materializes all results into memory.
For large datasets, prefer stream() for memory-efficient iteration.</p>
<p>Files are always tried first (free, no credentials), with automatic fallback
to BigQuery on rate limit/error if credentials are configured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deduplicate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, deduplicate events based on dedupe_strategy</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dedupe_strategy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.utils.dedup.DedupeStrategy">DedupeStrategy</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deduplication strategy (default: URL_DATE_LOCATION)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult containing Event instances. Use .data to access the list,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>.failed to see any failed requests, and .complete to check if all</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>requests succeeded.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     actor1_country="USA",
... )
result = await endpoint.query(filter_obj, deduplicate=True)
print(f"Found {len(result)} unique events")
for event in result:
...     print(event.global_event_id)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/events.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query GDELT Events with automatic fallback.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    This is a batch query method that materializes all results into memory.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    For large datasets, prefer stream() for memory-efficient iteration.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        FetchResult containing Event instances. Use .data to access the list,</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        .failed to see any failed requests, and .complete to check if all</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        requests succeeded.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        &gt;&gt;&gt; result = await endpoint.query(filter_obj, deduplicate=True)</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Found {len(result)} unique events&quot;)</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        &gt;&gt;&gt; for event in result:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        ...     print(event.global_event_id)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="c1"># Default dedupe strategy</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">dedupe_strategy</span> <span class="o">=</span> <span class="n">DedupeStrategy</span><span class="o">.</span><span class="n">URL_DATE_LOCATION</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>    <span class="c1"># Fetch raw events first (for deduplication)</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="n">raw_events_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_RawEvent</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="n">raw_event</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="p">]</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fetched </span><span class="si">%d</span><span class="s2"> raw events from sources&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">))</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="c1"># Apply deduplication on raw events if requested</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="c1"># Deduplication happens on _RawEvent which implements HasDedupeFields protocol</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">original_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="c1"># Convert to iterator, deduplicate, then back to list</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">raw_events_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">apply_dedup</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">),</span> <span class="n">dedupe_strategy</span><span class="p">))</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="s2">&quot;Deduplicated </span><span class="si">%d</span><span class="s2"> events to </span><span class="si">%d</span><span class="s2"> unique (strategy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">original_count</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="nb">len</span><span class="p">(</span><span class="n">raw_events_list</span><span class="p">),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="c1"># Convert _RawEvent to Event models after deduplication</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">events</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="n">raw_events_list</span><span class="p">:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_event</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Converted </span><span class="si">%d</span><span class="s2"> events to Event models&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">))</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="c1"># Return as FetchResult (no failed requests tracked yet)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">events</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.events.EventsEndpoint.stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deduplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Stream GDELT Events with memory-efficient iteration.</p>
<p>This is a streaming method that yields events one at a time, making it
suitable for large datasets. Memory usage is constant regardless of
result size.</p>
<p>Files are always tried first (free, no credentials), with automatic fallback
to BigQuery on rate limit/error if credentials are configured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deduplicate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, deduplicate events based on dedupe_strategy</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dedupe_strategy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.utils.dedup.DedupeStrategy">DedupeStrategy</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deduplication strategy (default: URL_DATE_LOCATION)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Event</code></td>            <td>
                  <code><span title="collections.abc.AsyncIterator">AsyncIterator</span>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individual Event instances matching the filter</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),
...     actor1_country="USA",
... )
count = 0
async for event in endpoint.stream(filter_obj, deduplicate=True):
...     print(event.global_event_id)
...     count += 1
print(f"Streamed {count} unique events")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/events.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream GDELT Events with memory-efficient iteration.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    This is a streaming method that yields events one at a time, making it</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    suitable for large datasets. Memory usage is constant regardless of</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    result size.</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">    Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">    to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        Event: Individual Event instances matching the filter</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &gt;&gt;&gt; count = 0</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        &gt;&gt;&gt; async for event in endpoint.stream(filter_obj, deduplicate=True):</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        ...     print(event.global_event_id)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        ...     count += 1</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Streamed {count} unique events&quot;)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="c1"># Default dedupe strategy</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">dedupe_strategy</span> <span class="o">=</span> <span class="n">DedupeStrategy</span><span class="o">.</span><span class="n">URL_DATE_LOCATION</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="c1"># Fetch raw events from DataFetcher</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">raw_events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_events</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="p">)</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="c1"># Apply deduplication if requested</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="k">if</span> <span class="n">deduplicate</span> <span class="ow">and</span> <span class="n">dedupe_strategy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Applying deduplication (strategy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="p">)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="n">raw_events</span> <span class="o">=</span> <span class="n">apply_dedup_async</span><span class="p">(</span><span class="n">raw_events</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="p">)</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="c1"># Convert _RawEvent to Event at yield boundary</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>    <span class="k">async</span> <span class="k">for</span> <span class="n">raw_event</span> <span class="ow">in</span> <span class="n">raw_events</span><span class="p">:</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_event</span><span class="p">)</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Streamed </span><span class="si">%d</span><span class="s2"> events&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.events.EventsEndpoint.query_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deduplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for query().</p>
<p>This is a convenience method that runs the async query() method
in a new event loop. Prefer using the async version when possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deduplicate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, deduplicate events based on dedupe_strategy</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dedupe_strategy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.utils.dedup.DedupeStrategy">DedupeStrategy</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deduplication strategy (default: URL_DATE_LOCATION)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult containing Event instances</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within an already running event loop</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     actor1_country="USA",
... )
result = endpoint.query_sync(filter_obj)
for event in result:
...     print(event.global_event_id)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/events.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    This is a convenience method that runs the async query() method</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    in a new event loop. Prefer using the async version when possible.</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        FetchResult containing Event instances</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        &gt;&gt;&gt; for event in result:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        ...     print(event.global_event_id)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>            <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">deduplicate</span><span class="o">=</span><span class="n">deduplicate</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="n">dedupe_strategy</span><span class="o">=</span><span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="p">),</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.events.EventsEndpoint.stream_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">deduplicate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dedupe_strategy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for stream().</p>
<p>This method provides a synchronous iterator interface over async streaming.
It internally manages the event loop and yields events one at a time,
providing true streaming behavior with memory efficiency.</p>
<p>Note: This creates a new event loop for each iteration, which has some overhead.
For better performance, use the async stream() method directly if possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deduplicate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, deduplicate events based on dedupe_strategy</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dedupe_strategy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.utils.dedup.DedupeStrategy">DedupeStrategy</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Deduplication strategy (default: URL_DATE_LOCATION)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="Event (py_gdelt.models.events.Event)" href="../models/#py_gdelt.models.Event">Event</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterator that yields Event instances for each matching event</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within an already running event loop</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     actor1_country="USA",
... )
for event in endpoint.stream_sync(filter_obj, deduplicate=True):
...     print(event.global_event_id)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/events.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">deduplicate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">dedupe_strategy</span><span class="p">:</span> <span class="n">DedupeStrategy</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">    This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    It internally manages the event loop and yields events one at a time,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    providing true streaming behavior with memory efficiency.</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">    For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        filter_obj: Event filter with date range and query parameters</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        deduplicate: If True, deduplicate events based on dedupe_strategy</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        dedupe_strategy: Deduplication strategy (default: URL_DATE_LOCATION)</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        Iterator that yields Event instances for each matching event</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        RateLimitError: If rate limited and fallback not available</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        APIError: If download fails and fallback not available</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        ...     actor1_country=&quot;USA&quot;,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        &gt;&gt;&gt; for event in endpoint.stream_sync(filter_obj, deduplicate=True):</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        ...     print(event.global_event_id)</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Event</span><span class="p">]:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="n">deduplicate</span><span class="o">=</span><span class="n">deduplicate</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>            <span class="n">dedupe_strategy</span><span class="o">=</span><span class="n">dedupe_strategy</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="p">):</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>    <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>        <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>                <span class="n">event</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>                <span class="k">yield</span> <span class="n">event</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>                <span class="k">break</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="mentionsendpoint">MentionsEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.mentions.MentionsEndpoint" class="doc doc-heading">
            <code>MentionsEndpoint</code>


</h3>


    <div class="doc doc-contents first">



        <p>Endpoint for querying GDELT Mentions data.</p>
<p>Mentions track individual occurrences of events across different news sources.
Each mention links to an event in the Events table via GlobalEventID and contains
metadata about the source, timing, document position, and confidence.</p>
<p>This endpoint uses DataFetcher for multi-source orchestration:
- Primary: File downloads (free, no credentials needed)
- Fallback: BigQuery (on rate limit/error, if credentials configured)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.files.FileSource">FileSource</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FileSource instance for downloading GDELT files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bigquery_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.bigquery.BigQuerySource">BigQuerySource</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional BigQuerySource instance for fallback queries</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GDELTSettings (py_gdelt.config.GDELTSettings)" href="../client/#py_gdelt.config.GDELTSettings">GDELTSettings</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional GDELTSettings for configuration (currently unused but
reserved for future features like caching)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fallback_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fallback to BigQuery on errors (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_policy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.fetcher.ErrorPolicy">ErrorPolicy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to handle errors - 'raise', 'warn', or 'skip' (default: 'warn')</p>
              </div>
            </td>
            <td>
                  <code>&#39;warn&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>Mentions queries require BigQuery as files don't support event-specific filtering.
File downloads would require fetching entire date ranges and filtering client-side,
which is inefficient for single-event queries.
BigQuery fallback only activates if both fallback_enabled=True AND
bigquery_source is provided AND credentials are configured.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import DateRange, EventFilter
from py_gdelt.sources import FileSource, BigQuerySource
from py_gdelt.sources.fetcher import DataFetcher</p>
<p>async with FileSource() as file_source:
...     bq_source = BigQuerySource()
...     fetcher = DataFetcher(file_source=file_source, bigquery_source=bq_source)
...     endpoint = MentionsEndpoint(fetcher=fetcher)
...
...     filter_obj = EventFilter(
...         date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))
...     )
...
...     # Batch query
...     result = await endpoint.query(global_event_id="123456789", filter_obj=filter_obj)
...     print(f"Found {len(result)} mentions")
...     for mention in result:
...         print(mention.source_name)
...
...     # Streaming query
...     async for mention in endpoint.stream(global_event_id="123456789", filter_obj=filter_obj):
...         print(mention.source_name)</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/mentions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="k">class</span><span class="w"> </span><span class="nc">MentionsEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint for querying GDELT Mentions data.</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    Mentions track individual occurrences of events across different news sources.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Each mention links to an event in the Events table via GlobalEventID and contains</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    metadata about the source, timing, document position, and confidence.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    This endpoint uses DataFetcher for multi-source orchestration:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    - Primary: File downloads (free, no credentials needed)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    - Fallback: BigQuery (on rate limit/error, if credentials configured)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        file_source: FileSource instance for downloading GDELT files</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        bigquery_source: Optional BigQuerySource instance for fallback queries</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        settings: Optional GDELTSettings for configuration (currently unused but</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">            reserved for future features like caching)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        fallback_enabled: Whether to fallback to BigQuery on errors (default: True)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        error_policy: How to handle errors - &#39;raise&#39;, &#39;warn&#39;, or &#39;skip&#39; (default: &#39;warn&#39;)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        Mentions queries require BigQuery as files don&#39;t support event-specific filtering.</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        File downloads would require fetching entire date ranges and filtering client-side,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        which is inefficient for single-event queries.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        BigQuery fallback only activates if both fallback_enabled=True AND</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        bigquery_source is provided AND credentials are configured.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import DateRange, EventFilter</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.sources import FileSource, BigQuerySource</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.sources.fetcher import DataFetcher</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        &gt;&gt;&gt; async with FileSource() as file_source:</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        ...     bq_source = BigQuerySource()</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        ...     fetcher = DataFetcher(file_source=file_source, bigquery_source=bq_source)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        ...     endpoint = MentionsEndpoint(fetcher=fetcher)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        ...</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        ...     filter_obj = EventFilter(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        ...         date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        ...</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        ...     # Batch query</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        ...     result = await endpoint.query(global_event_id=&quot;123456789&quot;, filter_obj=filter_obj)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        ...     print(f&quot;Found {len(result)} mentions&quot;)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        ...     for mention in result:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        ...         print(mention.source_name)</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        ...</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ...     # Streaming query</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        ...     async for mention in endpoint.stream(global_event_id=&quot;123456789&quot;, filter_obj=filter_obj):</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        ...         print(mention.source_name)</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="n">file_source</span><span class="p">:</span> <span class="n">FileSource</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="n">bigquery_source</span><span class="p">:</span> <span class="n">BigQuerySource</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">settings</span><span class="p">:</span> <span class="n">GDELTSettings</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="n">fallback_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>        <span class="n">error_policy</span><span class="p">:</span> <span class="n">ErrorPolicy</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.sources.fetcher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFetcher</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">settings</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="p">:</span> <span class="n">DataFetcher</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">(</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">file_source</span><span class="o">=</span><span class="n">file_source</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">bigquery_source</span><span class="o">=</span><span class="n">bigquery_source</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">fallback_enabled</span><span class="o">=</span><span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">error_policy</span><span class="o">=</span><span class="n">error_policy</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="p">)</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s2">&quot;MentionsEndpoint initialized (fallback_enabled=</span><span class="si">%s</span><span class="s2">, error_policy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">error_policy</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query mentions for a specific event and return all results.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">        This method collects all mentions into memory and returns them as a FetchResult.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        For large result sets or memory-constrained environments, use stream() instead.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">            global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">            filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">            use_bigquery: If True, use BigQuery directly (default: True, recommended for mentions)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            FetchResult[Mention]: Container with list of Mention objects and failure tracking</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            ValueError: If date range is invalid or too large</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            &gt;&gt;&gt; result = await endpoint.query(123456789, filter_obj)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Complete: {result.complete}, Count: {len(result)}&quot;)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">            &gt;&gt;&gt; for mention in result:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            ...     print(f&quot;{mention.source_name}: {mention.confidence}%&quot;)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="s2">&quot;Querying mentions for event </span><span class="si">%s</span><span class="s2"> (date_range=</span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">, use_bigquery=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="ow">or</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="c1"># Collect all mentions</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">mentions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">mention</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="k">async</span> <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>                <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>            <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="p">]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="s2">&quot;Query complete: fetched </span><span class="si">%d</span><span class="s2"> mentions for event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>            <span class="nb">len</span><span class="p">(</span><span class="n">mentions</span><span class="p">),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="c1"># For now, return FetchResult with no failures</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="c1"># In future, we could track file-level failures if using file source</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mentions</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream mentions for a specific event.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        This method yields mentions one at a time, converting from internal _RawMention</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        to public Mention model at the yield boundary. Memory-efficient for large result sets.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            use_bigquery: If True, use BigQuery directly (default: True, recommended for mentions)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">            Mention: Individual mention records with full type safety</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">            ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            ValueError: If date range is invalid or too large</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            &gt;&gt;&gt; async for mention in endpoint.stream(123456789, filter_obj):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            ...     if mention.confidence &gt;= 80:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            ...         print(f&quot;High confidence: {mention.source_name}&quot;)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="s2">&quot;Streaming mentions for event </span><span class="si">%s</span><span class="s2"> (date_range=</span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="ow">or</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="n">mentions_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="c1"># Use DataFetcher to query mentions</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="c1"># Note: fetch_mentions() returns AsyncIterator[_RawMention] (or dict from BigQuery)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="n">raw_mentions</span><span class="p">:</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">_RawMention</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_mentions</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># Convert _RawMention to Mention at yield boundary</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">raw_mention</span> <span class="ow">in</span> <span class="n">raw_mentions</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="c1"># DataFetcher.fetch_mentions() returns dicts from BigQuery</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="c1"># We need to convert them to Mention</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="c1"># For now, assume BigQuery returns compatible dict structure</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="c1"># BigQuery returns dict - convert to Mention directly</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="c1"># This is a simplified implementation - in production, we&#39;d need proper BigQuery row mapping</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="n">mention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_mention</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="c1"># File source would return _RawMention (though mentions don&#39;t come from files typically)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="n">mention</span> <span class="o">=</span> <span class="n">Mention</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">mentions_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Streamed </span><span class="si">%d</span><span class="s2"> mentions for event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mentions_count</span><span class="p">,</span> <span class="n">global_event_id</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_dict_to_mention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Mention</span><span class="p">:</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert BigQuery row dict to Mention model.</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        This is a helper to bridge the gap between BigQuery result dicts and our Pydantic models.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        BigQuery returns rows as dictionaries, which we need to map to our internal structure.</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            row: BigQuery row as dictionary</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            Mention: Validated Mention instance</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            This is a temporary implementation. In production, we&#39;d use a proper BigQuery row mapper</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            that handles field name translations and type conversions.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># Import here to avoid circular dependency</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.models._internal</span><span class="w"> </span><span class="kn">import</span> <span class="n">_RawMention</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="c1"># Map BigQuery column names to _RawMention fields</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># BigQuery uses different naming (e.g., EventTimeDate vs event_time_date)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">raw_mention</span> <span class="o">=</span> <span class="n">_RawMention</span><span class="p">(</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">global_event_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GlobalEventID&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>            <span class="n">event_time_date</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EventTimeDate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>            <span class="n">event_time_full</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;EventTimeFullDate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>            <span class="n">mention_time_date</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionTimeDate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">mention_time_full</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionTimeFullDate&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">mention_type</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionType&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">mention_source_name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionSourceName&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">mention_identifier</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionIdentifier&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">sentence_id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SentenceID&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">actor1_char_offset</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Actor1CharOffset&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>            <span class="n">actor2_char_offset</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Actor2CharOffset&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>            <span class="n">action_char_offset</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ActionCharOffset&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>            <span class="n">in_raw_text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;InRawText&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>            <span class="n">confidence</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Confidence&quot;</span><span class="p">,</span> <span class="s2">&quot;50&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>            <span class="n">mention_doc_length</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionDocLen&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>            <span class="n">mention_doc_tone</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionDocTone&quot;</span><span class="p">,</span> <span class="s2">&quot;0.0&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="n">mention_doc_translation_info</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MentionDocTranslationInfo&quot;</span><span class="p">),</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>            <span class="n">extras</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Extras&quot;</span><span class="p">),</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="p">)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="k">return</span> <span class="n">Mention</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        This is a convenience method for synchronous code. It runs the async query()</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        method in a new event loop. For better performance, use the async version directly.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            use_bigquery: If True, use BigQuery directly (default: True)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            FetchResult[Mention]: Container with list of Mention objects</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            ValueError: If date range is invalid</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            &gt;&gt;&gt; result = endpoint.query_sync(123456789, filter_obj)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            &gt;&gt;&gt; for mention in result:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            ...     print(mention.source_name)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>                <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>            <span class="p">),</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="p">)</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        It internally manages the event loop and yields mentions one at a time,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        providing true streaming behavior with memory efficiency.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">            global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">            filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">            use_bigquery: If True, use BigQuery directly (default: True)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">            Iterator of individual Mention records</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">            ValueError: If date range is invalid</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">            &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">            &gt;&gt;&gt; for mention in endpoint.stream_sync(123456789, filter_obj):</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">            ...     print(mention.source_name)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>            <span class="k">async</span> <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>                <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>                <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>                <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>            <span class="p">):</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>                <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>        <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>            <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                    <span class="n">mention</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                    <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>                <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                    <span class="k">break</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>            <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.mentions.MentionsEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">global_event_id</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query mentions for a specific event and return all results.</p>
<p>This method collects all mentions into memory and returns them as a FetchResult.
For large result sets or memory-constrained environments, use stream() instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>global_event_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Global event ID to fetch mentions for (integer)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range for the query window</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use BigQuery directly (default: True, recommended for mentions)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Mention (py_gdelt.models.events.Mention)" href="../models/#py_gdelt.models.Mention">Mention</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult[Mention]: Container with list of Mention objects and failure tracking</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery not configured but required</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If date range is invalid or too large</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))
... )
result = await endpoint.query(123456789, filter_obj)
print(f"Complete: {result.complete}, Count: {len(result)}")
for mention in result:
...     print(f"{mention.source_name}: {mention.confidence}%")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/mentions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query mentions for a specific event and return all results.</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a><span class="sd">    This method collects all mentions into memory and returns them as a FetchResult.</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    For large result sets or memory-constrained environments, use stream() instead.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="sd">        global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="sd">        filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a><span class="sd">        use_bigquery: If True, use BigQuery directly (default: True, recommended for mentions)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        FetchResult[Mention]: Container with list of Mention objects and failure tracking</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        ValueError: If date range is invalid or too large</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        &gt;&gt;&gt; result = await endpoint.query(123456789, filter_obj)</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Complete: {result.complete}, Count: {len(result)}&quot;)</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &gt;&gt;&gt; for mention in result:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        ...     print(f&quot;{mention.source_name}: {mention.confidence}%&quot;)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="s2">&quot;Querying mentions for event </span><span class="si">%s</span><span class="s2"> (date_range=</span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">, use_bigquery=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="ow">or</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="c1"># Collect all mentions</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">mentions</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Mention</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">mention</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>    <span class="p">]</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="s2">&quot;Query complete: fetched </span><span class="si">%d</span><span class="s2"> mentions for event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="nb">len</span><span class="p">(</span><span class="n">mentions</span><span class="p">),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>        <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="c1"># For now, return FetchResult with no failures</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="c1"># In future, we could track file-level failures if using file source</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mentions</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.mentions.MentionsEndpoint.stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream</span><span class="p">(</span><span class="n">global_event_id</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Stream mentions for a specific event.</p>
<p>This method yields mentions one at a time, converting from internal _RawMention
to public Mention model at the yield boundary. Memory-efficient for large result sets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>global_event_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Global event ID to fetch mentions for (integer)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range for the query window</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use BigQuery directly (default: True, recommended for mentions)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Mention</code></td>            <td>
                  <code><span title="collections.abc.AsyncIterator">AsyncIterator</span>[<a class="autorefs autorefs-internal" title="Mention (py_gdelt.models.events.Mention)" href="../models/#py_gdelt.models.Mention">Mention</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individual mention records with full type safety</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery not configured but required</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If date range is invalid or too large</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))
... )
async for mention in endpoint.stream(123456789, filter_obj):
...     if mention.confidence &gt;= 80:
...         print(f"High confidence: {mention.source_name}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/mentions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream mentions for a specific event.</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    This method yields mentions one at a time, converting from internal _RawMention</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    to public Mention model at the yield boundary. Memory-efficient for large result sets.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        use_bigquery: If True, use BigQuery directly (default: True, recommended for mentions)</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        Mention: Individual mention records with full type safety</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        ValueError: If date range is invalid or too large</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        &gt;&gt;&gt; async for mention in endpoint.stream(123456789, filter_obj):</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        ...     if mention.confidence &gt;= 80:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        ...         print(f&quot;High confidence: {mention.source_name}&quot;)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="s2">&quot;Streaming mentions for event </span><span class="si">%s</span><span class="s2"> (date_range=</span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">end</span> <span class="ow">or</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">date_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">mentions_count</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="c1"># Use DataFetcher to query mentions</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="c1"># Note: fetch_mentions() returns AsyncIterator[_RawMention] (or dict from BigQuery)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="n">raw_mentions</span><span class="p">:</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">_RawMention</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_mentions</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="c1"># Convert _RawMention to Mention at yield boundary</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">async</span> <span class="k">for</span> <span class="n">raw_mention</span> <span class="ow">in</span> <span class="n">raw_mentions</span><span class="p">:</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="c1"># DataFetcher.fetch_mentions() returns dicts from BigQuery</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="c1"># We need to convert them to Mention</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="c1"># For now, assume BigQuery returns compatible dict structure</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="c1"># BigQuery returns dict - convert to Mention directly</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="c1"># This is a simplified implementation - in production, we&#39;d need proper BigQuery row mapping</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">mention</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_mention</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="c1"># File source would return _RawMention (though mentions don&#39;t come from files typically)</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">mention</span> <span class="o">=</span> <span class="n">Mention</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_mention</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">mentions_count</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Streamed </span><span class="si">%d</span><span class="s2"> mentions for event </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mentions_count</span><span class="p">,</span> <span class="n">global_event_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.mentions.MentionsEndpoint.query_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_sync</span><span class="p">(</span><span class="n">global_event_id</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for query().</p>
<p>This is a convenience method for synchronous code. It runs the async query()
method in a new event loop. For better performance, use the async version directly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>global_event_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Global event ID to fetch mentions for (integer)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range for the query window</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use BigQuery directly (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="Mention (py_gdelt.models.events.Mention)" href="../models/#py_gdelt.models.Mention">Mention</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult[Mention]: Container with list of Mention objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery not configured but required</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If date range is invalid</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))
... )
result = endpoint.query_sync(123456789, filter_obj)
for mention in result:
...     print(mention.source_name)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/mentions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    This is a convenience method for synchronous code. It runs the async query()</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">    method in a new event loop. For better performance, use the async version directly.</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        use_bigquery: If True, use BigQuery directly (default: True)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        FetchResult[Mention]: Container with list of Mention objects</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        ValueError: If date range is invalid</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        &gt;&gt;&gt; result = endpoint.query_sync(123456789, filter_obj)</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        &gt;&gt;&gt; for mention in result:</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        ...     print(mention.source_name)</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="p">),</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.mentions.MentionsEndpoint.stream_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream_sync</span><span class="p">(</span><span class="n">global_event_id</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for stream().</p>
<p>This method provides a synchronous iterator interface over async streaming.
It internally manages the event loop and yields mentions one at a time,
providing true streaming behavior with memory efficiency.</p>
<p>Note: This creates a new event loop for each iteration, which has some overhead.
For better performance, use the async stream() method directly if possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>global_event_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Global event ID to fetch mentions for (integer)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="EventFilter (py_gdelt.filters.EventFilter)" href="../filters/#py_gdelt.filters.EventFilter">EventFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range for the query window</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use BigQuery directly (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="Mention (py_gdelt.models.events.Mention)" href="../models/#py_gdelt.models.Mention">Mention</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterator of individual Mention records</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery not configured but required</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If date range is invalid</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within an already running event loop</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = EventFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))
... )
for mention in endpoint.stream_sync(123456789, filter_obj):
...     print(mention.source_name)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/mentions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="n">global_event_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">EventFilter</span><span class="p">,</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    It internally manages the event loop and yields mentions one at a time,</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    providing true streaming behavior with memory efficiency.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">    Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">    For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a><span class="sd">        global_event_id: Global event ID to fetch mentions for (integer)</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        filter_obj: Filter with date range for the query window</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        use_bigquery: If True, use BigQuery directly (default: True)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a><span class="sd">        Iterator of individual Mention records</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        ConfigurationError: If BigQuery not configured but required</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">        ValueError: If date range is invalid</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        RuntimeError: If called from within an already running event loop</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">        &gt;&gt;&gt; filter_obj = EventFilter(</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7))</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        &gt;&gt;&gt; for mention in endpoint.stream_sync(123456789, filter_obj):</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        ...     print(mention.source_name)</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Mention</span><span class="p">]:</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>            <span class="n">global_event_id</span><span class="o">=</span><span class="n">global_event_id</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>            <span class="n">filter_obj</span><span class="o">=</span><span class="n">filter_obj</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>            <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="p">):</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>            <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>                <span class="n">mention</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>                <span class="k">yield</span> <span class="n">mention</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>            <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>                <span class="k">break</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>        <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="gkgendpoint">GKGEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.gkg.GKGEndpoint" class="doc doc-heading">
            <code>GKGEndpoint</code>


</h3>


    <div class="doc doc-contents first">



        <p>GKG (Global Knowledge Graph) endpoint for querying GDELT enriched content data.</p>
<p>The GKGEndpoint provides access to GDELT's Global Knowledge Graph, which contains
rich content analysis including themes, people, organizations, locations, counts,
tone, and other metadata extracted from news articles.</p>
<p>This endpoint uses DataFetcher to orchestrate source selection:
- Files are ALWAYS primary (free, no credentials needed)
- BigQuery is FALLBACK ONLY (on 429/error, if credentials configured)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.files.FileSource">FileSource</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FileSource instance for downloading GDELT files</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bigquery_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.bigquery.BigQuerySource">BigQuerySource</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional BigQuerySource instance for fallback queries</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GDELTSettings (py_gdelt.config.GDELTSettings)" href="../client/#py_gdelt.config.GDELTSettings">GDELTSettings</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional GDELTSettings for configuration (currently unused but
reserved for future features like caching)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fallback_enabled</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fallback to BigQuery on errors (default: True)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>error_policy</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.fetcher.ErrorPolicy">ErrorPolicy</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How to handle errors - 'raise', 'warn', or 'skip' (default: 'warn')</p>
              </div>
            </td>
            <td>
                  <code>&#39;warn&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>BigQuery fallback only activates if both fallback_enabled=True AND
bigquery_source is provided AND credentials are configured.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>Basic GKG query:</p>
<blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import GKGFilter, DateRange
from py_gdelt.endpoints.gkg import GKGEndpoint
from py_gdelt.sources.files import FileSource</p>
<p>async def main():
...     async with FileSource() as file_source:
...         endpoint = GKGEndpoint(file_source=file_source)
...         filter_obj = GKGFilter(
...             date_range=DateRange(start=date(2024, 1, 1)),
...             themes=["ENV_CLIMATECHANGE"]
...         )
...         result = await endpoint.query(filter_obj)
...         for record in result:
...             print(record.record_id, record.source_url)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Streaming large result sets:</p>
<blockquote>
<blockquote>
<blockquote>
<p>async def stream_example():
...     async with FileSource() as file_source:
...         endpoint = GKGEndpoint(file_source=file_source)
...         filter_obj = GKGFilter(
...             date_range=DateRange(start=date(2024, 1, 1)),
...             country="USA"
...         )
...         async for record in endpoint.stream(filter_obj):
...             print(record.record_id, record.primary_theme)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Synchronous usage:</p>
<blockquote>
<blockquote>
<blockquote>
<p>endpoint = GKGEndpoint(file_source=file_source)
result = endpoint.query_sync(filter_obj)
for record in result:
...     print(record.record_id)</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/gkg.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="k">class</span><span class="w"> </span><span class="nc">GKGEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;GKG (Global Knowledge Graph) endpoint for querying GDELT enriched content data.</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    The GKGEndpoint provides access to GDELT&#39;s Global Knowledge Graph, which contains</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    rich content analysis including themes, people, organizations, locations, counts,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    tone, and other metadata extracted from news articles.</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    This endpoint uses DataFetcher to orchestrate source selection:</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">    - Files are ALWAYS primary (free, no credentials needed)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    - BigQuery is FALLBACK ONLY (on 429/error, if credentials configured)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        file_source: FileSource instance for downloading GDELT files</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        bigquery_source: Optional BigQuerySource instance for fallback queries</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        settings: Optional GDELTSettings for configuration (currently unused but</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">            reserved for future features like caching)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        fallback_enabled: Whether to fallback to BigQuery on errors (default: True)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        error_policy: How to handle errors - &#39;raise&#39;, &#39;warn&#39;, or &#39;skip&#39; (default: &#39;warn&#39;)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        BigQuery fallback only activates if both fallback_enabled=True AND</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        bigquery_source is provided AND credentials are configured.</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        Basic GKG query:</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.endpoints.gkg import GKGEndpoint</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.sources.files import FileSource</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        &gt;&gt;&gt; async def main():</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        ...     async with FileSource() as file_source:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        ...         endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        ...         filter_obj = GKGFilter(</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        ...             date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        ...             themes=[&quot;ENV_CLIMATECHANGE&quot;]</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        ...         )</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        ...         result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        ...         for record in result:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        ...             print(record.record_id, record.source_url)</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Streaming large result sets:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        &gt;&gt;&gt; async def stream_example():</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">        ...     async with FileSource() as file_source:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        ...         endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        ...         filter_obj = GKGFilter(</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        ...             date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ...             country=&quot;USA&quot;</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        ...         )</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        ...         async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        ...             print(record.record_id, record.primary_theme)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        Synchronous usage:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        &gt;&gt;&gt; endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        &gt;&gt;&gt; for record in result:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ...     print(record.record_id)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">file_source</span><span class="p">:</span> <span class="n">FileSource</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="n">bigquery_source</span><span class="p">:</span> <span class="n">BigQuerySource</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">settings</span><span class="p">:</span> <span class="n">GDELTSettings</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="n">fallback_enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">error_policy</span><span class="p">:</span> <span class="n">ErrorPolicy</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.sources.fetcher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataFetcher</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">settings</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">(</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">file_source</span><span class="o">=</span><span class="n">file_source</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">bigquery_source</span><span class="o">=</span><span class="n">bigquery_source</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">fallback_enabled</span><span class="o">=</span><span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="n">error_policy</span><span class="o">=</span><span class="n">error_policy</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="s2">&quot;GKGEndpoint initialized (fallback_enabled=</span><span class="si">%s</span><span class="s2">, error_policy=</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="p">,</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="n">fallback_enabled</span><span class="p">,</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">error_policy</span><span class="p">,</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="p">)</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query GKG data with automatic fallback and return all results.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        This method fetches all matching GKG records and returns them as a FetchResult</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        container. For large result sets, consider using stream() instead to avoid</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        loading everything into memory.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">            filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            FetchResult[GKGRecord] containing all matching records and any failures</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            ...     themes=[&quot;ECON_STOCKMARKET&quot;],</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            ...     min_tone=0.0,  # Only positive tone</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            &gt;&gt;&gt; result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Fetched {len(result)} records&quot;)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            &gt;&gt;&gt; if not result.complete:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            ...     print(f&quot;Warning: {result.total_failed} requests failed&quot;)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            &gt;&gt;&gt; for record in result:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            ...     print(record.record_id, record.tone.tone if record.tone else None)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>        <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>            <span class="n">record</span> <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>        <span class="p">]</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GKG query completed: </span><span class="si">%d</span><span class="s2"> records fetched&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="c1"># Return FetchResult (failures tracked by DataFetcher error policy)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">records</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream GKG records with automatic fallback.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        This method streams GKG records one at a time, which is memory-efficient for</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        large result sets. Records are converted from internal _RawGKG dataclass to</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        public GKGRecord Pydantic model at the yield boundary.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">            filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            GKGRecord: Individual GKG records matching the filter criteria</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">            APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">            &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            ...     organizations=[&quot;United Nations&quot;],</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            &gt;&gt;&gt; count = 0</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            &gt;&gt;&gt; async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            ...     print(f&quot;Processing {record.record_id}&quot;)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            ...     count += 1</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            ...     if count &gt;= 1000:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            ...         break  # Stop after 1000 records</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting GKG stream for filter: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="c1"># Use DataFetcher to fetch raw GKG records</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">raw_gkg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_gkg</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="c1"># Convert _RawGKG to GKGRecord at yield boundary</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                <span class="n">record</span> <span class="o">=</span> <span class="n">GKGRecord</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_gkg</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="c1"># Error boundary: log conversion errors but continue processing other records</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to convert raw GKG record to GKGRecord: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="k">continue</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        This is a convenience method for synchronous code that internally uses</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        asyncio.run() to execute the async query() method.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">            FetchResult[GKGRecord] containing all matching records and any failures</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">            RuntimeError: If called from within an existing event loop</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            &gt;&gt;&gt; # Synchronous usage (no async/await needed)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            &gt;&gt;&gt; endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">            &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1))</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            &gt;&gt;&gt; for record in result:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            ...     print(record.record_id)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">))</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        It internally manages the event loop and yields records one at a time.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">            Iterator of GKGRecord instances for each matching record</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">            RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            RuntimeError: If called from within an existing event loop</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">            &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">            &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            &gt;&gt;&gt;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">            &gt;&gt;&gt; # Synchronous streaming (no async/await needed)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">            &gt;&gt;&gt; endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1))</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            &gt;&gt;&gt; for record in endpoint.stream_sync(filter_obj):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">            ...     print(record.record_id)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">            ...     if record.has_quotations:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            ...         print(f&quot;  {len(record.quotations)} quotations found&quot;)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>            <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">):</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>                <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>            <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                    <span class="n">record</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                    <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>                <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                    <span class="k">break</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>            <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.gkg.GKGEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query GKG data with automatic fallback and return all results.</p>
<p>This method fetches all matching GKG records and returns them as a FetchResult
container. For large result sets, consider using stream() instead to avoid
loading everything into memory.</p>
<p>Files are always tried first (free, no credentials), with automatic fallback
to BigQuery on rate limit/error if credentials are configured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GKGFilter (py_gdelt.filters.GKGFilter)" href="../filters/#py_gdelt.filters.GKGFilter">GKGFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GKG filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="GKGRecord (py_gdelt.models.gkg.GKGRecord)" href="../models/#py_gdelt.models.GKGRecord">GKGRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult[GKGRecord] containing all matching records and any failures</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import GKGFilter, DateRange</p>
<p>filter_obj = GKGFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     themes=["ECON_STOCKMARKET"],
...     min_tone=0.0,  # Only positive tone
... )
result = await endpoint.query(filter_obj)
print(f"Fetched {len(result)} records")
if not result.complete:
...     print(f"Warning: {result.total_failed} requests failed")
for record in result:
...     print(record.record_id, record.tone.tone if record.tone else None)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/gkg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query GKG data with automatic fallback and return all results.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    This method fetches all matching GKG records and returns them as a FetchResult</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">    container. For large result sets, consider using stream() instead to avoid</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">    loading everything into memory.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        FetchResult[GKGRecord] containing all matching records and any failures</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        ...     themes=[&quot;ECON_STOCKMARKET&quot;],</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        ...     min_tone=0.0,  # Only positive tone</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        &gt;&gt;&gt; result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Fetched {len(result)} records&quot;)</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        &gt;&gt;&gt; if not result.complete:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        ...     print(f&quot;Warning: {result.total_failed} requests failed&quot;)</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        &gt;&gt;&gt; for record in result:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        ...     print(record.record_id, record.tone.tone if record.tone else None)</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="n">record</span> <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="p">]</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;GKG query completed: </span><span class="si">%d</span><span class="s2"> records fetched&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="c1"># Return FetchResult (failures tracked by DataFetcher error policy)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">records</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.gkg.GKGEndpoint.stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Stream GKG records with automatic fallback.</p>
<p>This method streams GKG records one at a time, which is memory-efficient for
large result sets. Records are converted from internal _RawGKG dataclass to
public GKGRecord Pydantic model at the yield boundary.</p>
<p>Files are always tried first (free, no credentials), with automatic fallback
to BigQuery on rate limit/error if credentials are configured.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GKGFilter (py_gdelt.filters.GKGFilter)" href="../filters/#py_gdelt.filters.GKGFilter">GKGFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GKG filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GKGRecord</code></td>            <td>
                  <code><span title="collections.abc.AsyncIterator">AsyncIterator</span>[<a class="autorefs autorefs-internal" title="GKGRecord (py_gdelt.models.gkg.GKGRecord)" href="../models/#py_gdelt.models.GKGRecord">GKGRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individual GKG records matching the filter criteria</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import GKGFilter, DateRange</p>
<p>filter_obj = GKGFilter(
...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),
...     organizations=["United Nations"],
... )
count = 0
async for record in endpoint.stream(filter_obj):
...     print(f"Processing {record.record_id}")
...     count += 1
...     if count &gt;= 1000:
...         break  # Stop after 1000 records</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/gkg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream GKG records with automatic fallback.</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    This method streams GKG records one at a time, which is memory-efficient for</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    large result sets. Records are converted from internal _RawGKG dataclass to</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    public GKGRecord Pydantic model at the yield boundary.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Files are always tried first (free, no credentials), with automatic fallback</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    to BigQuery on rate limit/error if credentials are configured.</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        GKGRecord: Individual GKG records matching the filter criteria</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1), end=date(2024, 1, 7)),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        ...     organizations=[&quot;United Nations&quot;],</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        &gt;&gt;&gt; count = 0</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        ...     print(f&quot;Processing {record.record_id}&quot;)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        ...     count += 1</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        ...     if count &gt;= 1000:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        ...         break  # Stop after 1000 records</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Starting GKG stream for filter: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="c1"># Use DataFetcher to fetch raw GKG records</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="k">async</span> <span class="k">for</span> <span class="n">raw_gkg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_gkg</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">):</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="c1"># Convert _RawGKG to GKGRecord at yield boundary</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">record</span> <span class="o">=</span> <span class="n">GKGRecord</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_gkg</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="c1"># Error boundary: log conversion errors but continue processing other records</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Failed to convert raw GKG record to GKGRecord: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.gkg.GKGEndpoint.query_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for query().</p>
<p>This is a convenience method for synchronous code that internally uses
asyncio.run() to execute the async query() method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GKGFilter (py_gdelt.filters.GKGFilter)" href="../filters/#py_gdelt.filters.GKGFilter">GKGFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GKG filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="GKGRecord (py_gdelt.models.gkg.GKGRecord)" href="../models/#py_gdelt.models.GKGRecord">GKGRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult[GKGRecord] containing all matching records and any failures</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within an existing event loop</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import GKGFilter, DateRange</p>
<h5 id="py_gdelt.endpoints.gkg.GKGEndpoint.query_sync--synchronous-usage-no-asyncawait-needed">Synchronous usage (no async/await needed)</h5>
<p>endpoint = GKGEndpoint(file_source=file_source)
filter_obj = GKGFilter(
...     date_range=DateRange(start=date(2024, 1, 1))
... )
result = endpoint.query_sync(filter_obj)
for record in result:
...     print(record.record_id)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/gkg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">    This is a convenience method for synchronous code that internally uses</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">    asyncio.run() to execute the async query() method.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="sd">        FetchResult[GKGRecord] containing all matching records and any failures</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        RuntimeError: If called from within an existing event loop</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        &gt;&gt;&gt; # Synchronous usage (no async/await needed)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        &gt;&gt;&gt; endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1))</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        &gt;&gt;&gt; for record in result:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        ...     print(record.record_id)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for stream().</p>
<p>This method provides a synchronous iterator interface over async streaming.
It internally manages the event loop and yields records one at a time.</p>
<p>Note: This creates a new event loop for each iteration, which has some overhead.
For better performance, use the async stream() method directly if possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GKGFilter (py_gdelt.filters.GKGFilter)" href="../filters/#py_gdelt.filters.GKGFilter">GKGFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GKG filter with date range and query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_bigquery</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip files and use BigQuery directly (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="collections.abc.Iterator">Iterator</span>[<a class="autorefs autorefs-internal" title="GKGRecord (py_gdelt.models.gkg.GKGRecord)" href="../models/#py_gdelt.models.GKGRecord">GKGRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterator of GKGRecord instances for each matching record</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If download fails and fallback not available/enabled</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ConfigurationError (py_gdelt.exceptions.ConfigurationError)" href="../exceptions/#py_gdelt.exceptions.ConfigurationError">ConfigurationError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If BigQuery requested but not configured</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within an existing event loop</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from datetime import date
from py_gdelt.filters import GKGFilter, DateRange</p>
<h5 id="py_gdelt.endpoints.gkg.GKGEndpoint.stream_sync--synchronous-streaming-no-asyncawait-needed">Synchronous streaming (no async/await needed)</h5>
<p>endpoint = GKGEndpoint(file_source=file_source)
filter_obj = GKGFilter(
...     date_range=DateRange(start=date(2024, 1, 1))
... )
for record in endpoint.stream_sync(filter_obj):
...     print(record.record_id)
...     if record.has_quotations:
...         print(f"  {len(record.quotations)} quotations found")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/gkg.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">filter_obj</span><span class="p">:</span> <span class="n">GKGFilter</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">use_bigquery</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    This method provides a synchronous iterator interface over async streaming.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    It internally manages the event loop and yields records one at a time.</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    Note: This creates a new event loop for each iteration, which has some overhead.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    For better performance, use the async stream() method directly if possible.</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        filter_obj: GKG filter with date range and query parameters</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        use_bigquery: If True, skip files and use BigQuery directly (default: False)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Iterator of GKGRecord instances for each matching record</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        RateLimitError: If rate limited and fallback not available/enabled</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        APIError: If download fails and fallback not available/enabled</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        ConfigurationError: If BigQuery requested but not configured</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        RuntimeError: If called from within an existing event loop</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import GKGFilter, DateRange</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        &gt;&gt;&gt;</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a><span class="sd">        &gt;&gt;&gt; # Synchronous streaming (no async/await needed)</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        &gt;&gt;&gt; endpoint = GKGEndpoint(file_source=file_source)</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        &gt;&gt;&gt; filter_obj = GKGFilter(</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1))</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        &gt;&gt;&gt; for record in endpoint.stream_sync(filter_obj):</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        ...     print(record.record_id)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        ...     if record.has_quotations:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        ...         print(f&quot;  {len(record.quotations)} quotations found&quot;)</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_async_generator</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">GKGRecord</span><span class="p">]:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal async generator for sync wrapper.&quot;&quot;&quot;</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">,</span> <span class="n">use_bigquery</span><span class="o">=</span><span class="n">use_bigquery</span><span class="p">):</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>            <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="c1"># Run async generator and yield results synchronously</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="n">async_gen</span> <span class="o">=</span> <span class="n">_async_generator</span><span class="p">()</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>                <span class="n">record</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>                <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>                <span class="k">break</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="ngramsendpoint">NGramsEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.ngrams.NGramsEndpoint" class="doc doc-heading">
            <code>NGramsEndpoint</code>


</h3>


    <div class="doc doc-contents first">



        <p>Endpoint for querying GDELT NGrams 3.0 data.</p>
<p>Provides access to GDELT's NGrams dataset, which tracks word and phrase
occurrences across global news with contextual information. NGrams are
file-based only (no BigQuery support).</p>
<p>The endpoint uses DataFetcher for orchestrated file downloads with automatic
retry, error handling, and intelligent caching. Internal _RawNGram dataclass
instances are converted to Pydantic NGramRecord models at the yield boundary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GDELTSettings (py_gdelt.config.GDELTSettings)" href="../client/#py_gdelt.config.GDELTSettings">GDELTSettings</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration settings. If None, uses defaults.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_source</code>
            </td>
            <td>
                  <code><span title="py_gdelt.sources.files.FileSource">FileSource</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional shared FileSource. If None, creates owned instance.
        When provided, the source lifecycle is managed externally.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Batch query with filtering:</p>
<blockquote>
<blockquote>
<blockquote>
<p>from py_gdelt.filters import NGramsFilter, DateRange
from datetime import date
async with NGramsEndpoint() as endpoint:
...     filter_obj = NGramsFilter(
...         date_range=DateRange(start=date(2024, 1, 1)),
...         language="en",
...         ngram="climate",
...     )
...     result = await endpoint.query(filter_obj)
...     print(f"Found {len(result)} records")</p>
</blockquote>
</blockquote>
</blockquote>
<p>Streaming for large datasets:</p>
<blockquote>
<blockquote>
<blockquote>
<p>async with NGramsEndpoint() as endpoint:
...     filter_obj = NGramsFilter(
...         date_range=DateRange(
...             start=date(2024, 1, 1),
...             end=date(2024, 1, 7)
...         ),
...         language="en",
...     )
...     async for record in endpoint.stream(filter_obj):
...         if record.is_early_in_article:
...             print(f"Early: {record.ngram} in {record.url}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="k">class</span><span class="w"> </span><span class="nc">NGramsEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Endpoint for querying GDELT NGrams 3.0 data.</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    Provides access to GDELT&#39;s NGrams dataset, which tracks word and phrase</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    occurrences across global news with contextual information. NGrams are</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    file-based only (no BigQuery support).</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">    The endpoint uses DataFetcher for orchestrated file downloads with automatic</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    retry, error handling, and intelligent caching. Internal _RawNGram dataclass</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    instances are converted to Pydantic NGramRecord models at the yield boundary.</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">        settings: Configuration settings. If None, uses defaults.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        file_source: Optional shared FileSource. If None, creates owned instance.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">                    When provided, the source lifecycle is managed externally.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        Batch query with filtering:</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import NGramsFilter, DateRange</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        &gt;&gt;&gt; from datetime import date</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        &gt;&gt;&gt; async with NGramsEndpoint() as endpoint:</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        ...     filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        ...         date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        ...         language=&quot;en&quot;,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        ...         ngram=&quot;climate&quot;,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        ...     result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        ...     print(f&quot;Found {len(result)} records&quot;)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        Streaming for large datasets:</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        &gt;&gt;&gt; async with NGramsEndpoint() as endpoint:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        ...     filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        ...         date_range=DateRange(</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        ...             start=date(2024, 1, 1),</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        ...             end=date(2024, 1, 7)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        ...         ),</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">        ...         language=&quot;en&quot;,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        ...     async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        ...         if record.is_early_in_article:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        ...             print(f&quot;Early: {record.ngram} in {record.url}&quot;)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="n">settings</span><span class="p">:</span> <span class="n">GDELTSettings</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">file_source</span><span class="p">:</span> <span class="n">FileSource</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span> <span class="ow">or</span> <span class="n">GDELTSettings</span><span class="p">()</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>        <span class="k">if</span> <span class="n">file_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_source</span> <span class="o">=</span> <span class="n">file_source</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_owns_sources</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file_source</span> <span class="o">=</span> <span class="n">FileSource</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_owns_sources</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="c1"># Create DataFetcher with file source only (NGrams don&#39;t support BigQuery)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span> <span class="o">=</span> <span class="n">DataFetcher</span><span class="p">(</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="n">file_source</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_source</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="n">bigquery_source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="n">fallback_enabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">error_policy</span><span class="o">=</span><span class="s2">&quot;warn&quot;</span><span class="p">,</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="c1"># Create parser instance</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parser</span> <span class="o">=</span> <span class="n">NGramsParser</span><span class="p">()</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Close resources if we own them.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        Only closes resources that were created by this instance.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        Shared resources are not closed to allow reuse.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owns_sources</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="c1"># FileSource uses context manager protocol, manually call __aexit__</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_source</span><span class="o">.</span><span class="fm">__aexit__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NGramsEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Async context manager entry.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">            Self for use in async with statement.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Async context manager exit - close resources.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            *args: Exception info (unused, but required by protocol).</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query NGrams data and return all results.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Fetches all NGram records matching the filter criteria and returns them</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        as a FetchResult. This method collects all records in memory before returning,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        so use stream() for large result sets to avoid memory issues.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            filter_obj: Filter with date range and optional ngram/language constraints</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            FetchResult containing list of NGramRecord instances and any failed requests</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            APIError: If downloads fail</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            DataError: If file parsing fails</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            ...     min_position=0,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            ...     max_position=20,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            &gt;&gt;&gt; result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Found {len(result)} records in article headlines&quot;)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># Stream all records and collect them</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span> <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Collected </span><span class="si">%d</span><span class="s2"> NGram records from query&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="c1"># Return FetchResult (no failed tracking for now - DataFetcher handles errors)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">records</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Stream NGrams data record by record.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Yields NGram records one at a time, converting internal _RawNGram dataclass</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        instances to Pydantic NGramRecord models at the yield boundary. This method</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        is memory-efficient for large result sets.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        Client-side filtering is applied for ngram text, language, and position</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        constraints since file downloads provide all records for a date range.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">            filter_obj: Filter with date range and optional ngram/language constraints</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">            NGramRecord: Individual NGram records matching the filter criteria</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">            RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">            APIError: If downloads fail</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            DataError: If file parsing fails</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            ...     ngram=&quot;climate&quot;,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">            ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            &gt;&gt;&gt; async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            ...     print(f&quot;{record.ngram}: {record.context}&quot;)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="c1"># Use DataFetcher&#39;s fetch_ngrams method to get raw records</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">raw_record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_ngrams</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="c1"># Convert _RawNGram to NGramRecord (type conversion happens here)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                <span class="n">record</span> <span class="o">=</span> <span class="n">NGramRecord</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_record</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                    <span class="s2">&quot;Failed to convert raw ngram to NGramRecord: </span><span class="si">%s</span><span class="s2"> - Skipping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                    <span class="n">e</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="k">continue</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="c1"># Apply client-side filtering</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches_filter</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">):</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="k">continue</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_matches_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">:</span> <span class="n">NGramRecord</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if record matches filter criteria.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        Applies client-side filtering for ngram text, language, and position</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        constraints. Date filtering is handled by DataFetcher (file selection).</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            record: NGramRecord to check</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            filter_obj: Filter criteria</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            True if record matches all filter criteria, False otherwise</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># Filter by ngram text (case-insensitive substring match)</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="k">if</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">ngram</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">ngram</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">record</span><span class="o">.</span><span class="n">ngram</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="c1"># Filter by language (exact match)</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">if</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">language</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">record</span><span class="o">.</span><span class="n">language</span> <span class="o">!=</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">language</span><span class="p">:</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="c1"># Filter by position (article decile)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="k">if</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">min_position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">record</span><span class="o">.</span><span class="n">position</span> <span class="o">&lt;</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">min_position</span><span class="p">:</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">filter_obj</span><span class="o">.</span><span class="n">max_position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">record</span><span class="o">.</span><span class="n">position</span> <span class="o">&gt;</span> <span class="n">filter_obj</span><span class="o">.</span><span class="n">max_position</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Runs the async query() method in a new event loop. This is a convenience</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        method for synchronous code, but async methods are preferred when possible.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">            filter_obj: Filter with date range and optional constraints</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">            FetchResult containing list of NGramRecord instances</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">            APIError: If downloads fail</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">            DataError: If file parsing fails</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">            &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Found {len(result)} records&quot;)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">))</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        Yields NGram records from the async stream() method in a blocking manner.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        This is a convenience method for synchronous code, but async methods are</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        preferred when possible.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">            filter_obj: Filter with date range and optional constraints</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">        Yields:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">            NGramRecord: Individual NGram records matching the filter criteria</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">            RuntimeError: If called from within a running event loop.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">            RateLimitError: If rate limited and retries exhausted.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">            APIError: If downloads fail.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">            DataError: If file parsing fails.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">        Note:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">            This method cannot be called from within an async context (e.g., inside</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            an async function or running event loop). Doing so will raise RuntimeError.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">            Use the async stream() method instead. This method creates its own event</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">            loop internally.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">            ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">            ...     ngram=&quot;climate&quot;,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            &gt;&gt;&gt; for record in endpoint.stream_sync(filter_obj):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">            ...     print(f&quot;{record.ngram}: {record.url}&quot;)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="c1"># Manual event loop management is required for async generators.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="c1"># Unlike query_sync() which uses asyncio.run() for a single coroutine,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="c1"># stream_sync() must iterate through an async generator step-by-step.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="c1"># asyncio.run() cannot handle async generators - it expects a coroutine</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="c1"># that returns a value, not one that yields multiple values.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="c1"># Check if we&#39;re already in an async context - this would cause issues</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>            <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>            <span class="n">has_running_loop</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>            <span class="n">has_running_loop</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>        <span class="k">if</span> <span class="n">has_running_loop</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;stream_sync() cannot be called from a running event loop. Use stream() instead.&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">async_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>                <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                    <span class="n">record</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                    <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>                <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                    <span class="k">break</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>            <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Close resources if we own them.</p>
<p>Only closes resources that were created by this instance.
Shared resources are not closed to allow reuse.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Close resources if we own them.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Only closes resources that were created by this instance.</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">    Shared resources are not closed to allow reuse.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_owns_sources</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="c1"># FileSource uses context manager protocol, manually call __aexit__</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_source</span><span class="o">.</span><span class="fm">__aexit__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.__aenter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__aenter__</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Async context manager entry.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramsEndpoint (py_gdelt.endpoints.ngrams.NGramsEndpoint)" href="#py_gdelt.endpoints.ngrams.NGramsEndpoint">NGramsEndpoint</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Self for use in async with statement.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NGramsEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Async context manager entry.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Self for use in async with statement.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.__aexit__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__aexit__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Async context manager exit - close resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exception info (unused, but required by protocol).</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aexit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Async context manager exit - close resources.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        *args: Exception info (unused, but required by protocol).</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query NGrams data and return all results.</p>
<p>Fetches all NGram records matching the filter criteria and returns them
as a FetchResult. This method collects all records in memory before returning,
so use stream() for large result sets to avoid memory issues.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramsFilter (py_gdelt.filters.NGramsFilter)" href="../filters/#py_gdelt.filters.NGramsFilter">NGramsFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range and optional ngram/language constraints</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="NGramRecord (py_gdelt.models.ngrams.NGramRecord)" href="../models/#py_gdelt.models.NGramRecord">NGramRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult containing list of NGramRecord instances and any failed requests</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and retries exhausted</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If downloads fail</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DataError (py_gdelt.exceptions.DataError)" href="../exceptions/#py_gdelt.exceptions.DataError">DataError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If file parsing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = NGramsFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     language="en",
...     min_position=0,
...     max_position=20,
... )
result = await endpoint.query(filter_obj)
print(f"Found {len(result)} records in article headlines")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query NGrams data and return all results.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">    Fetches all NGram records matching the filter criteria and returns them</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    as a FetchResult. This method collects all records in memory before returning,</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    so use stream() for large result sets to avoid memory issues.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        filter_obj: Filter with date range and optional ngram/language constraints</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        FetchResult containing list of NGramRecord instances and any failed requests</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        APIError: If downloads fail</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        DataError: If file parsing fails</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        ...     min_position=0,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        ...     max_position=20,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        &gt;&gt;&gt; result = await endpoint.query(filter_obj)</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Found {len(result)} records in article headlines&quot;)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="c1"># Stream all records and collect them</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">records</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">record</span> <span class="k">async</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Collected </span><span class="si">%d</span><span class="s2"> NGram records from query&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">))</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="c1"># Return FetchResult (no failed tracking for now - DataFetcher handles errors)</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="k">return</span> <span class="n">FetchResult</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">records</span><span class="p">,</span> <span class="n">failed</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.stream" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Stream NGrams data record by record.</p>
<p>Yields NGram records one at a time, converting internal _RawNGram dataclass
instances to Pydantic NGramRecord models at the yield boundary. This method
is memory-efficient for large result sets.</p>
<p>Client-side filtering is applied for ngram text, language, and position
constraints since file downloads provide all records for a date range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramsFilter (py_gdelt.filters.NGramsFilter)" href="../filters/#py_gdelt.filters.NGramsFilter">NGramsFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range and optional ngram/language constraints</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NGramRecord</code></td>            <td>
                  <code><span title="collections.abc.AsyncIterator">AsyncIterator</span>[<a class="autorefs autorefs-internal" title="NGramRecord (py_gdelt.models.ngrams.NGramRecord)" href="../models/#py_gdelt.models.NGramRecord">NGramRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individual NGram records matching the filter criteria</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and retries exhausted</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If downloads fail</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DataError (py_gdelt.exceptions.DataError)" href="../exceptions/#py_gdelt.exceptions.DataError">DataError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If file parsing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = NGramsFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     ngram="climate",
...     language="en",
... )
async for record in endpoint.stream(filter_obj):
...     print(f"{record.ngram}: {record.context}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">stream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream NGrams data record by record.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Yields NGram records one at a time, converting internal _RawNGram dataclass</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    instances to Pydantic NGramRecord models at the yield boundary. This method</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    is memory-efficient for large result sets.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Client-side filtering is applied for ngram text, language, and position</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    constraints since file downloads provide all records for a date range.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        filter_obj: Filter with date range and optional ngram/language constraints</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        NGramRecord: Individual NGram records matching the filter criteria</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        APIError: If downloads fail</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        DataError: If file parsing fails</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        ...     ngram=&quot;climate&quot;,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; async for record in endpoint.stream(filter_obj):</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        ...     print(f&quot;{record.ngram}: {record.context}&quot;)</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="c1"># Use DataFetcher&#39;s fetch_ngrams method to get raw records</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="k">async</span> <span class="k">for</span> <span class="n">raw_record</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetcher</span><span class="o">.</span><span class="n">fetch_ngrams</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">):</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="c1"># Convert _RawNGram to NGramRecord (type conversion happens here)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>            <span class="n">record</span> <span class="o">=</span> <span class="n">NGramRecord</span><span class="o">.</span><span class="n">from_raw</span><span class="p">(</span><span class="n">raw_record</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>                <span class="s2">&quot;Failed to convert raw ngram to NGramRecord: </span><span class="si">%s</span><span class="s2"> - Skipping&quot;</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="n">e</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="k">continue</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="c1"># Apply client-side filtering</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matches_filter</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">):</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="k">continue</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="k">yield</span> <span class="n">record</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.query_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for query().</p>
<p>Runs the async query() method in a new event loop. This is a convenience
method for synchronous code, but async methods are preferred when possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramsFilter (py_gdelt.filters.NGramsFilter)" href="../filters/#py_gdelt.filters.NGramsFilter">NGramsFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range and optional constraints</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="FetchResult


  
      dataclass
   (py_gdelt.models.common.FetchResult)" href="../models/#py_gdelt.models.FetchResult">FetchResult</a>[<a class="autorefs autorefs-internal" title="NGramRecord (py_gdelt.models.ngrams.NGramRecord)" href="../models/#py_gdelt.models.NGramRecord">NGramRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>FetchResult containing list of NGramRecord instances</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and retries exhausted</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If downloads fail</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DataError (py_gdelt.exceptions.DataError)" href="../exceptions/#py_gdelt.exceptions.DataError">DataError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If file parsing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = NGramsFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     language="en",
... )
result = endpoint.query_sync(filter_obj)
print(f"Found {len(result)} records")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="k">def</span><span class="w"> </span><span class="nf">query_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FetchResult</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for query().</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    Runs the async query() method in a new event loop. This is a convenience</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    method for synchronous code, but async methods are preferred when possible.</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">        filter_obj: Filter with date range and optional constraints</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        FetchResult containing list of NGramRecord instances</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        RateLimitError: If rate limited and retries exhausted</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">        APIError: If downloads fail</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        DataError: If file parsing fails</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        ...     language=&quot;en&quot;,</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        &gt;&gt;&gt; result = endpoint.query_sync(filter_obj)</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        &gt;&gt;&gt; print(f&quot;Found {len(result)} records&quot;)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.ngrams.NGramsEndpoint.stream_sync" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stream_sync</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Synchronous wrapper for stream().</p>
<p>Yields NGram records from the async stream() method in a blocking manner.
This is a convenience method for synchronous code, but async methods are
preferred when possible.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filter_obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramsFilter (py_gdelt.filters.NGramsFilter)" href="../filters/#py_gdelt.filters.NGramsFilter">NGramsFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter with date range and optional constraints</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NGramRecord</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="NGramRecord (py_gdelt.models.ngrams.NGramRecord)" href="../models/#py_gdelt.models.NGramRecord">NGramRecord</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Individual NGram records matching the filter criteria</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from within a running event loop.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limited and retries exhausted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If downloads fail.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DataError (py_gdelt.exceptions.DataError)" href="../exceptions/#py_gdelt.exceptions.DataError">DataError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If file parsing fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This method cannot be called from within an async context (e.g., inside
an async function or running event loop). Doing so will raise RuntimeError.
Use the async stream() method instead. This method creates its own event
loop internally.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>filter_obj = NGramsFilter(
...     date_range=DateRange(start=date(2024, 1, 1)),
...     ngram="climate",
... )
for record in endpoint.stream_sync(filter_obj):
...     print(f"{record.ngram}: {record.url}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/ngrams.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="k">def</span><span class="w"> </span><span class="nf">stream_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_obj</span><span class="p">:</span> <span class="n">NGramsFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">NGramRecord</span><span class="p">]:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Synchronous wrapper for stream().</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Yields NGram records from the async stream() method in a blocking manner.</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">    This is a convenience method for synchronous code, but async methods are</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">    preferred when possible.</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a><span class="sd">        filter_obj: Filter with date range and optional constraints</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a><span class="sd">    Yields:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a><span class="sd">        NGramRecord: Individual NGram records matching the filter criteria</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a><span class="sd">        RuntimeError: If called from within a running event loop.</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a><span class="sd">        RateLimitError: If rate limited and retries exhausted.</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="sd">        APIError: If downloads fail.</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="sd">        DataError: If file parsing fails.</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a><span class="sd">    Note:</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        This method cannot be called from within an async context (e.g., inside</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        an async function or running event loop). Doing so will raise RuntimeError.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a><span class="sd">        Use the async stream() method instead. This method creates its own event</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        loop internally.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        &gt;&gt;&gt; filter_obj = NGramsFilter(</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        ...     date_range=DateRange(start=date(2024, 1, 1)),</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        ...     ngram=&quot;climate&quot;,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        &gt;&gt;&gt; for record in endpoint.stream_sync(filter_obj):</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        ...     print(f&quot;{record.ngram}: {record.url}&quot;)</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>    <span class="c1"># Manual event loop management is required for async generators.</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="c1"># Unlike query_sync() which uses asyncio.run() for a single coroutine,</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="c1"># stream_sync() must iterate through an async generator step-by-step.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="c1"># asyncio.run() cannot handle async generators - it expects a coroutine</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>    <span class="c1"># that returns a value, not one that yields multiple values.</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="c1"># Check if we&#39;re already in an async context - this would cause issues</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>        <span class="n">has_running_loop</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a>        <span class="n">has_running_loop</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>    <span class="k">if</span> <span class="n">has_running_loop</span><span class="p">:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;stream_sync() cannot be called from a running event loop. Use stream() instead.&quot;</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a>    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">new_event_loop</span><span class="p">()</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">async_gen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">filter_obj</span><span class="p">)</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>                <span class="n">record</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">async_gen</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">())</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>                <span class="k">yield</span> <span class="n">record</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>            <span class="k">except</span> <span class="ne">StopAsyncIteration</span><span class="p">:</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>                <span class="k">break</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="rest-api-endpoints">REST API Endpoints</h2>
<h3 id="docendpoint">DocEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.doc.DocEndpoint" class="doc doc-heading">
            <code>DocEndpoint</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="py_gdelt.endpoints.base.BaseEndpoint">BaseEndpoint</span></code></p>



        <p>DOC 2.0 API endpoint for searching GDELT articles.</p>
<p>The DOC API provides full-text search across GDELT's monitored news sources
with support for various output modes (article lists, timelines, galleries)
and flexible filtering by time, source, language, and relevance.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="py_gdelt.endpoints.doc.DocEndpoint.BASE_URL">BASE_URL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base URL for the DOC API endpoint</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Basic article search:</p>
<blockquote>
<blockquote>
<blockquote>
<p>async with DocEndpoint() as doc:
...     articles = await doc.search("climate change", max_results=100)
...     for article in articles:
...         print(article.title, article.url)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Using filters for advanced queries:</p>
<blockquote>
<blockquote>
<blockquote>
<p>from py_gdelt.filters import DocFilter
async with DocEndpoint() as doc:
...     filter = DocFilter(
...         query="elections",
...         timespan="7d",
...         source_country="US",
...         sort_by="relevance"
...     )
...     articles = await doc.query(filter)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Getting timeline data:</p>
<blockquote>
<blockquote>
<blockquote>
<p>async with DocEndpoint() as doc:
...     timeline = await doc.timeline("protests", timespan="30d")
...     for point in timeline.points:
...         print(point.date, point.value)</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/doc.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="k">class</span><span class="w"> </span><span class="nc">DocEndpoint</span><span class="p">(</span><span class="n">BaseEndpoint</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    DOC 2.0 API endpoint for searching GDELT articles.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    The DOC API provides full-text search across GDELT&#39;s monitored news sources</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    with support for various output modes (article lists, timelines, galleries)</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    and flexible filtering by time, source, language, and relevance.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        BASE_URL: Base URL for the DOC API endpoint</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        Basic article search:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        ...     articles = await doc.search(&quot;climate change&quot;, max_results=100)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        ...     for article in articles:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        ...         print(article.title, article.url)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        Using filters for advanced queries:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import DocFilter</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        ...     filter = DocFilter(</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        ...         query=&quot;elections&quot;,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        ...         timespan=&quot;7d&quot;,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        ...         source_country=&quot;US&quot;,</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        ...         sort_by=&quot;relevance&quot;</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">        ...     articles = await doc.query(filter)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        Getting timeline data:</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">        ...     timeline = await doc.timeline(&quot;protests&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        ...     for point in timeline.points:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        ...         print(point.date, point.value)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.gdeltproject.org/api/v2/doc/doc&quot;</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build DOC API URL.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">        The DOC API uses a fixed URL with all parameters passed as query strings.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            **kwargs: Unused, but required by BaseEndpoint interface.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">            Base URL for DOC API requests.</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">DocFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        Build query parameters from DocFilter.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        Converts the DocFilter model into URL query parameters expected by</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        the DOC API, including proper format conversion for dates and</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        mapping of sort values to API parameter names.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            query_filter: Query filter with search parameters.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            Dict of query parameters ready for API request.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">            &gt;&gt;&gt; filter = DocFilter(query=&quot;test&quot;, timespan=&quot;24h&quot;, sort_by=&quot;relevance&quot;)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">            &gt;&gt;&gt; endpoint = DocEndpoint()</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">            &gt;&gt;&gt; params = endpoint._build_params(filter)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">            &gt;&gt;&gt; params[&quot;query&quot;]</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">            &#39;test&#39;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            &gt;&gt;&gt; params[&quot;sort&quot;]</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">            &#39;rel&#39;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s2">&quot;maxrecords&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">query_filter</span><span class="o">.</span><span class="n">max_results</span><span class="p">),</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="p">}</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="c1"># Map sort values to API parameter names</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">sort_map</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="s2">&quot;relevance&quot;</span><span class="p">:</span> <span class="s2">&quot;rel&quot;</span><span class="p">,</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="s2">&quot;tone&quot;</span><span class="p">:</span> <span class="s2">&quot;tonedesc&quot;</span><span class="p">,</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="p">}</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;sort&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sort_map</span><span class="p">[</span><span class="n">query_filter</span><span class="o">.</span><span class="n">sort_by</span><span class="p">]</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="c1"># Time constraints - timespan takes precedence over datetime range</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;timespan&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">elif</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;startdatetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">start_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">end_datetime</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;enddatetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">end_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="c1"># Source filters</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">source_language</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;sourcelang&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">source_language</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">source_country</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;sourcecountry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">source_country</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="n">sort_by</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;relevance&quot;</span><span class="p">,</span> <span class="s2">&quot;tone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">source_language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">source_country</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Article</span><span class="p">]:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        Search for articles matching a query.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        This is a convenience method that constructs a DocFilter internally.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        For more control over query parameters, use query() with a DocFilter directly.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            query: Search query string (supports boolean operators, phrases).</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            timespan: Time range like &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;. If None, searches all time.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            max_results: Maximum results to return (1-250, default: 250).</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            sort_by: Sort order - &quot;date&quot;, &quot;relevance&quot;, or &quot;tone&quot; (default: &quot;date&quot;).</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            source_language: Filter by source language (ISO 639 code).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            source_country: Filter by source country (FIPS country code).</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">            List of Article objects matching the query.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">            APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            ...     # Search recent articles about climate</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            ...     articles = await doc.search(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            ...         &quot;climate change&quot;,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            ...         timespan=&quot;7d&quot;,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            ...         max_results=50,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            ...         sort_by=&quot;relevance&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            ...     )</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            ...     # Filter by country</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            ...     us_articles = await doc.search(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">            ...         &quot;elections&quot;,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            ...         source_country=&quot;US&quot;,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">            ...         timespan=&quot;24h&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">            ...     )</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">DocFilter</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">sort_by</span><span class="o">=</span><span class="n">sort_by</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="n">source_language</span><span class="o">=</span><span class="n">source_language</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="n">source_country</span><span class="o">=</span><span class="n">source_country</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>        <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">DocFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Article</span><span class="p">]:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        Query the DOC API with a filter.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        Executes a search using a pre-configured DocFilter object, providing</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        full control over all query parameters.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">            query_filter: DocFilter with query parameters and constraints.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">            List of Article objects matching the filter criteria.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">            APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">            RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">            &gt;&gt;&gt; from py_gdelt.filters import DocFilter</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">            &gt;&gt;&gt; from datetime import datetime</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">            &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">            ...     # Complex query with datetime range</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            ...     doc_filter = DocFilter(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            ...         query=&#39;&quot;machine learning&quot; AND python&#39;,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            ...         start_datetime=datetime(2024, 1, 1),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">            ...         end_datetime=datetime(2024, 1, 31),</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            ...         source_country=&quot;US&quot;,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            ...         max_results=100,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">            ...         sort_by=&quot;relevance&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">            ...     )</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            ...     articles = await doc.query(doc_filter)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.models.articles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Article</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="c1"># Parse response - handle both empty and populated responses</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">Article</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;articles&quot;</span><span class="p">,</span> <span class="p">[])]</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">timeline</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timeline</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Get timeline data for a query.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Returns time series data showing article volume over time for a given</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        search query. Useful for visualizing trends and tracking story evolution.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            query: Search query string.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            timespan: Time range to analyze (default: &quot;7d&quot; - 7 days).</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                     Common values: &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;, &quot;3mon&quot;.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            Timeline object with time series data points.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">            APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            ...     # Get article volume over last month</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            ...     timeline = await doc.timeline(&quot;protests&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">            ...     for point in timeline.points:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">            ...         print(f&quot;{point.date}: {point.value} articles&quot;)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.models.articles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Timeline</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">DocFilter</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;timelinevol&quot;</span><span class="p">,</span>  <span class="c1"># GDELT API uses &#39;timelinevol&#39;, not &#39;timeline&#39;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="k">return</span> <span class="n">Timeline</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.doc.DocEndpoint.search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">sort_by</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">source_language</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source_country</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Search for articles matching a query.</p>
<p>This is a convenience method that constructs a DocFilter internally.
For more control over query parameters, use query() with a DocFilter directly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query string (supports boolean operators, phrases).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range like "24h", "7d", "30d". If None, searches all time.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum results to return (1-250, default: 250).</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sort_by</code>
            </td>
            <td>
                  <code><span title="typing.Literal">Literal</span>[&#39;date&#39;, &#39;relevance&#39;, &#39;tone&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sort order - "date", "relevance", or "tone" (default: "date").</p>
              </div>
            </td>
            <td>
                  <code>&#39;date&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_language</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by source language (ISO 639 code).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>source_country</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by source country (FIPS country code).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Article (py_gdelt.models.articles.Article)" href="../models/#py_gdelt.models.Article">Article</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Article objects matching the query.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On HTTP errors or invalid responses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When API is down or unreachable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When rate limited by the API.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>async with DocEndpoint() as doc:
...     # Search recent articles about climate
...     articles = await doc.search(
...         "climate change",
...         timespan="7d",
...         max_results=50,
...         sort_by="relevance"
...     )
...     # Filter by country
...     us_articles = await doc.search(
...         "elections",
...         source_country="US",
...         timespan="24h"
...     )</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/doc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">sort_by</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;relevance&quot;</span><span class="p">,</span> <span class="s2">&quot;tone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">source_language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="n">source_country</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Article</span><span class="p">]:</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    Search for articles matching a query.</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    This is a convenience method that constructs a DocFilter internally.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    For more control over query parameters, use query() with a DocFilter directly.</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        query: Search query string (supports boolean operators, phrases).</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        timespan: Time range like &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;. If None, searches all time.</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        max_results: Maximum results to return (1-250, default: 250).</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        sort_by: Sort order - &quot;date&quot;, &quot;relevance&quot;, or &quot;tone&quot; (default: &quot;date&quot;).</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        source_language: Filter by source language (ISO 639 code).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        source_country: Filter by source country (FIPS country code).</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        List of Article objects matching the query.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        ...     # Search recent articles about climate</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        ...     articles = await doc.search(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        ...         &quot;climate change&quot;,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        ...         timespan=&quot;7d&quot;,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        ...         max_results=50,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        ...         sort_by=&quot;relevance&quot;</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        ...     # Filter by country</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">        ...     us_articles = await doc.search(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        ...         &quot;elections&quot;,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        ...         source_country=&quot;US&quot;,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        ...         timespan=&quot;24h&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">DocFilter</span><span class="p">(</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">sort_by</span><span class="o">=</span><span class="n">sort_by</span><span class="p">,</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">source_language</span><span class="o">=</span><span class="n">source_language</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>        <span class="n">source_country</span><span class="o">=</span><span class="n">source_country</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="p">)</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.doc.DocEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query the DOC API with a filter.</p>
<p>Executes a search using a pre-configured DocFilter object, providing
full control over all query parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_filter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DocFilter (py_gdelt.filters.DocFilter)" href="../filters/#py_gdelt.filters.DocFilter">DocFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DocFilter with query parameters and constraints.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Article (py_gdelt.models.articles.Article)" href="../models/#py_gdelt.models.Article">Article</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Article objects matching the filter criteria.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On HTTP errors or invalid responses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When API is down or unreachable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When rate limited by the API.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from py_gdelt.filters import DocFilter
from datetime import datetime
async with DocEndpoint() as doc:
...     # Complex query with datetime range
...     doc_filter = DocFilter(
...         query='"machine learning" AND python',
...         start_datetime=datetime(2024, 1, 1),
...         end_datetime=datetime(2024, 1, 31),
...         source_country="US",
...         max_results=100,
...         sort_by="relevance"
...     )
...     articles = await doc.query(doc_filter)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/doc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">DocFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Article</span><span class="p">]:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    Query the DOC API with a filter.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Executes a search using a pre-configured DocFilter object, providing</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">    full control over all query parameters.</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        query_filter: DocFilter with query parameters and constraints.</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="sd">        List of Article objects matching the filter criteria.</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        &gt;&gt;&gt; from py_gdelt.filters import DocFilter</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        &gt;&gt;&gt; from datetime import datetime</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        ...     # Complex query with datetime range</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        ...     doc_filter = DocFilter(</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        ...         query=&#39;&quot;machine learning&quot; AND python&#39;,</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        ...         start_datetime=datetime(2024, 1, 1),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        ...         end_datetime=datetime(2024, 1, 31),</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        ...         source_country=&quot;US&quot;,</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        ...         max_results=100,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="sd">        ...         sort_by=&quot;relevance&quot;</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        ...     )</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        ...     articles = await doc.query(doc_filter)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.models.articles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Article</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="c1"># Parse response - handle both empty and populated responses</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">Article</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;articles&quot;</span><span class="p">,</span> <span class="p">[])]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.doc.DocEndpoint.timeline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timeline</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="s1">&#39;7d&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get timeline data for a query.</p>
<p>Returns time series data showing article volume over time for a given
search query. Useful for visualizing trends and tracking story evolution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query string.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range to analyze (default: "7d" - 7 days).
     Common values: "24h", "7d", "30d", "3mon".</p>
              </div>
            </td>
            <td>
                  <code>&#39;7d&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Timeline (py_gdelt.models.articles.Timeline)" href="../models/#py_gdelt.models.Timeline">Timeline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timeline object with time series data points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On HTTP errors or invalid responses.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When API is down or unreachable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When rate limited by the API.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>async with DocEndpoint() as doc:
...     # Get article volume over last month
...     timeline = await doc.timeline("protests", timespan="30d")
...     for point in timeline.points:
...         print(f"{point.date}: {point.value} articles")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/doc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">timeline</span><span class="p">(</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timeline</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Get timeline data for a query.</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Returns time series data showing article volume over time for a given</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">    search query. Useful for visualizing trends and tracking story evolution.</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        query: Search query string.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        timespan: Time range to analyze (default: &quot;7d&quot; - 7 days).</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">                 Common values: &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;, &quot;3mon&quot;.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        Timeline object with time series data points.</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        APIError: On HTTP errors or invalid responses.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        APIUnavailableError: When API is down or unreachable.</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        RateLimitError: When rate limited by the API.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        &gt;&gt;&gt; async with DocEndpoint() as doc:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        ...     # Get article volume over last month</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        ...     timeline = await doc.timeline(&quot;protests&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        ...     for point in timeline.points:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">        ...         print(f&quot;{point.date}: {point.value} articles&quot;)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">py_gdelt.models.articles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Timeline</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">DocFilter</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;timelinevol&quot;</span><span class="p">,</span>  <span class="c1"># GDELT API uses &#39;timelinevol&#39;, not &#39;timeline&#39;</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="k">return</span> <span class="n">Timeline</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="geoendpoint">GeoEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.geo.GeoEndpoint" class="doc doc-heading">
            <code>GeoEndpoint</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="py_gdelt.endpoints.base.BaseEndpoint">BaseEndpoint</span></code></p>



        <p>GEO 2.0 API endpoint for geographic article data.</p>
<p>Returns locations mentioned in news articles matching a query.
Supports time-based filtering and geographic bounds.</p>


<details class="example" open>
  <summary>Example</summary>
  <p>async with GeoEndpoint() as geo:
    result = await geo.search("earthquake", max_points=100)
    for point in result.points:
        print(f"{point.name}: {point.count} articles")</p>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="py_gdelt.endpoints.geo.GeoEndpoint.BASE_URL">BASE_URL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GEO API base URL</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/geo.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="k">class</span><span class="w"> </span><span class="nc">GeoEndpoint</span><span class="p">(</span><span class="n">BaseEndpoint</span><span class="p">):</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;GEO 2.0 API endpoint for geographic article data.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Returns locations mentioned in news articles matching a query.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Supports time-based filtering and geographic bounds.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        async with GeoEndpoint() as geo:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            result = await geo.search(&quot;earthquake&quot;, max_points=100)</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">            for point in result.points:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">                print(f&quot;{point.name}: {point.count} articles&quot;)</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        BASE_URL: GEO API base URL</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.gdeltproject.org/api/v2/geo/geo&quot;</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build GEO API URL.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        The GEO API uses a fixed base URL with query parameters.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">            **kwargs: Unused, kept for BaseEndpoint compatibility</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">            Base URL for GEO API</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">GeoFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build query parameters from GeoFilter.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            query_filter: GeoFilter with query parameters</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">            Dict of URL query parameters</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;GeoJSON&quot;</span><span class="p">,</span>  <span class="c1"># GDELT GEO API requires exact case</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="s2">&quot;maxpoints&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">query_filter</span><span class="o">.</span><span class="n">max_results</span><span class="p">),</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="p">}</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;timespan&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="c1"># Add bounding box if provided (format: lon1,lat1,lon2,lat2)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>            <span class="n">min_lat</span><span class="p">,</span> <span class="n">min_lon</span><span class="p">,</span> <span class="n">max_lat</span><span class="p">,</span> <span class="n">max_lon</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">bounding_box</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;BBOX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">min_lon</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">min_lat</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">max_lon</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">max_lat</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">max_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">bounding_box</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoResult</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Search for geographic locations in news.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">            query: Search query (full text search)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;1m&quot;)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">            max_points: Maximum points to return (1-250)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">            bounding_box: Optional (min_lat, min_lon, max_lat, max_lon)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            GeoResult with list of GeoPoints</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            async with GeoEndpoint() as geo:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">                result = await geo.search(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                    &quot;earthquake&quot;,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                    timespan=&quot;7d&quot;,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                    max_points=50</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">                )</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">                print(f&quot;Found {len(result.points)} locations&quot;)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">GeoFilter</span><span class="p">(</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">max_results</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">max_points</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>  <span class="c1"># Cap at filter max</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="n">bounding_box</span><span class="o">=</span><span class="n">bounding_box</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>        <span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">GeoFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoResult</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query the GEO API with a filter.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            query_filter: GeoFilter with query parameters</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            GeoResult containing geographic points</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            APIError: On request failure</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            RateLimitError: On rate limit</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            APIUnavailableError: On server error</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>        <span class="c1"># Parse GeoJSON features or raw points</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>        <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">GeoPoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>        <span class="k">if</span> <span class="s2">&quot;features&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>            <span class="c1"># GeoJSON format</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>            <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                <span class="n">coords</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                <span class="n">props</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                        <span class="n">GeoPoint</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                            <span class="n">lon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                            <span class="n">lat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                            <span class="n">name</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                            <span class="n">count</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                            <span class="n">url</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                        <span class="p">),</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                    <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">elif</span> <span class="s2">&quot;points&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="c1"># Plain JSON format</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">GeoPoint</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;points&quot;</span><span class="p">]])</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="k">return</span> <span class="n">GeoResult</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">total_count</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)),</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_geojson</span><span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">max_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get raw GeoJSON response.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Useful for direct use with mapping libraries (Leaflet, Folium, etc).</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">            query: Search query</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">            max_points: Maximum points (1-250)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">            Raw GeoJSON dict (FeatureCollection)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">            async with GeoEndpoint() as geo:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">                geojson = await geo.to_geojson(&quot;climate change&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">                # Pass directly to mapping library</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">                folium.GeoJson(geojson).add_to(map)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">GeoFilter</span><span class="p">(</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="n">max_results</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">max_points</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;geojson&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;dict[str, Any]&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.geo.GeoEndpoint.search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Search for geographic locations in news.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query (full text search)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (e.g., "24h", "7d", "1m")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_points</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum points to return (1-250)</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bounding_box</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>, <span title="float">float</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional (min_lat, min_lon, max_lat, max_lon)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="py_gdelt.endpoints.geo.GeoResult">GeoResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoResult with list of GeoPoints</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>async with GeoEndpoint() as geo:
    result = await geo.search(
        "earthquake",
        timespan="7d",
        max_points=50
    )
    print(f"Found {len(result.points)} locations")</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/geo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">max_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">bounding_box</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoResult</span><span class="p">:</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Search for geographic locations in news.</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="sd">        query: Search query (full text search)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="sd">        timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;1m&quot;)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        max_points: Maximum points to return (1-250)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        bounding_box: Optional (min_lat, min_lon, max_lat, max_lon)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        GeoResult with list of GeoPoints</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        async with GeoEndpoint() as geo:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">            result = await geo.search(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">                &quot;earthquake&quot;,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">                timespan=&quot;7d&quot;,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">                max_points=50</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            )</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            print(f&quot;Found {len(result.points)} locations&quot;)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">GeoFilter</span><span class="p">(</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>        <span class="n">max_results</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">max_points</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>  <span class="c1"># Cap at filter max</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>        <span class="n">bounding_box</span><span class="o">=</span><span class="n">bounding_box</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>    <span class="p">)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.geo.GeoEndpoint.query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query the GEO API with a filter.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_filter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="GeoFilter (py_gdelt.filters.GeoFilter)" href="../filters/#py_gdelt.filters.GeoFilter">GeoFilter</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoFilter with query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="py_gdelt.endpoints.geo.GeoResult">GeoResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoResult containing geographic points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On request failure</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On rate limit</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On server error</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/geo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">GeoFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoResult</span><span class="p">:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the GEO API with a filter.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        query_filter: GeoFilter with query parameters</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        GeoResult containing geographic points</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        APIError: On request failure</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">        RateLimitError: On rate limit</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        APIUnavailableError: On server error</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>    <span class="c1"># Parse GeoJSON features or raw points</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">GeoPoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="k">if</span> <span class="s2">&quot;features&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="c1"># GeoJSON format</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">coords</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">props</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                    <span class="n">GeoPoint</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                        <span class="n">lon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                        <span class="n">lat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                        <span class="n">name</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                        <span class="n">count</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                        <span class="n">url</span><span class="o">=</span><span class="n">props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                    <span class="p">),</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="p">)</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">elif</span> <span class="s2">&quot;points&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="c1"># Plain JSON format</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="n">points</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">GeoPoint</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;points&quot;</span><span class="p">]])</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">return</span> <span class="n">GeoResult</span><span class="p">(</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">total_count</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)),</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.geo.GeoEndpoint.to_geojson" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_geojson</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_points</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get raw GeoJSON response.</p>
<p>Useful for direct use with mapping libraries (Leaflet, Folium, etc).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (e.g., "24h", "7d")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_points</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum points (1-250)</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw GeoJSON dict (FeatureCollection)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>async with GeoEndpoint() as geo:
    geojson = await geo.to_geojson("climate change", timespan="30d")
    # Pass directly to mapping library
    folium.GeoJson(geojson).add_to(map)</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/geo.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-202" name="__codelineno-0-202"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_geojson</span><span class="p">(</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">max_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get raw GeoJSON response.</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Useful for direct use with mapping libraries (Leaflet, Folium, etc).</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        query: Search query</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        max_points: Maximum points (1-250)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        Raw GeoJSON dict (FeatureCollection)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="sd">        async with GeoEndpoint() as geo:</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="sd">            geojson = await geo.to_geojson(&quot;climate change&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">            # Pass directly to mapping library</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a><span class="sd">            folium.GeoJson(geojson).add_to(map)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">GeoFilter</span><span class="p">(</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="n">max_results</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">max_points</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="p">)</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;geojson&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;dict[str, Any]&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="contextendpoint">ContextEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.context.ContextEndpoint" class="doc doc-heading">
            <code>ContextEndpoint</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="py_gdelt.endpoints.base.BaseEndpoint">BaseEndpoint</span></code></p>



        <p>Context 2.0 API endpoint for contextual analysis.</p>
<p>Provides contextual information about search terms including
related themes, entities, and sentiment analysis.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="py_gdelt.endpoints.context.ContextEndpoint.BASE_URL">BASE_URL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base URL for the Context API endpoint</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>async with ContextEndpoint() as ctx:
    result = await ctx.analyze("climate change")
    for theme in result.themes[:5]:
        print(f"{theme.theme}: {theme.count} mentions")</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/context.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="k">class</span><span class="w"> </span><span class="nc">ContextEndpoint</span><span class="p">(</span><span class="n">BaseEndpoint</span><span class="p">):</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Context 2.0 API endpoint for contextual analysis.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    Provides contextual information about search terms including</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    related themes, entities, and sentiment analysis.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        BASE_URL: Base URL for the Context API endpoint</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        async with ContextEndpoint() as ctx:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">            result = await ctx.analyze(&quot;climate change&quot;)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            for theme in result.themes[:5]:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">                print(f&quot;{theme.theme}: {theme.count} mentions&quot;)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.gdeltproject.org/api/v2/context/context&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContextEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Async context manager entry.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">            Self for use in async with statement.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__aenter__</span><span class="p">()</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="k">return</span> <span class="bp">self</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build Context API URL.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">        The Context API uses a single endpoint URL with query parameters.</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">            **kwargs: Unused, included for BaseEndpoint compatibility.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            Base URL for Context API.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_params</span><span class="p">(</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build query parameters for Context API request.</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">            query: Search term to analyze</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">            Dictionary of query parameters for the API request.</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;artlist&quot;</span><span class="p">,</span>  <span class="c1"># GDELT Context API only supports &#39;artlist&#39; mode</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="p">}</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;timespan&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timespan</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContextResult</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get contextual analysis for a search term.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        Retrieves comprehensive contextual information including themes, entities,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        tone analysis, and related queries for the specified search term.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">            query: Search term to analyze</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            ContextResult with themes, entities, and tone analysis</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            RateLimitError: On 429 response</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># Parse themes</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">themes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextTheme</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="n">ContextTheme</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>                <span class="n">theme</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;theme&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>                <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>                <span class="n">score</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">),</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="p">]</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="c1"># Parse entities</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="n">entities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextEntity</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="n">ContextEntity</span><span class="p">(</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="n">entity_type</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;UNKNOWN&quot;</span><span class="p">),</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entities&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="p">]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="c1"># Parse tone</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="n">tone</span><span class="p">:</span> <span class="n">ContextTone</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="k">if</span> <span class="s2">&quot;tone&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>            <span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;tone&quot;</span><span class="p">]</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="n">tone</span> <span class="o">=</span> <span class="n">ContextTone</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>                <span class="n">average_tone</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                <span class="n">positive_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="n">negative_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="n">neutral_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neutral&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="c1"># Parse related queries</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">related</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;related_queries&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">related_queries</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">related</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">related</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">return</span> <span class="n">ContextResult</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="n">article_count</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;article_count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="n">themes</span><span class="o">=</span><span class="n">themes</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="n">entities</span><span class="o">=</span><span class="n">entities</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">tone</span><span class="o">=</span><span class="n">tone</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">related_queries</span><span class="o">=</span><span class="n">related_queries</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_themes</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextTheme</span><span class="p">]:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get top themes for a search term.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        Convenience method that returns just themes sorted by count.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            query: Search term</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">            timespan: Time range</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">            limit: Max themes to return</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            List of top themes sorted by count (descending)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">            RateLimitError: On 429 response</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">            APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="n">sorted_themes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">themes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="k">return</span> <span class="n">sorted_themes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_entities</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextEntity</span><span class="p">]:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get top entities for a search term.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Convenience method that returns entities, optionally filtered by type</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        and sorted by count.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">            query: Search term</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">            timespan: Time range</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">            entity_type: Filter by type (PERSON, ORG, LOCATION)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">            limit: Max entities to return</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">            List of top entities sorted by count (descending)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">            RateLimitError: On 429 response</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">            APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">            APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="n">entities</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">entities</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">if</span> <span class="n">entity_type</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">entities</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">==</span> <span class="n">entity_type</span><span class="p">]</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="n">sorted_entities</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">entities</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">return</span> <span class="n">sorted_entities</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.context.ContextEndpoint.__aenter__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__aenter__</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Async context manager entry.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="ContextEndpoint (py_gdelt.endpoints.context.ContextEndpoint)" href="#py_gdelt.endpoints.context.ContextEndpoint">ContextEndpoint</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Self for use in async with statement.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-121" name="__codelineno-0-121"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContextEndpoint</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Async context manager entry.</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a><span class="sd">        Self for use in async with statement.</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="k">await</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__aenter__</span><span class="p">()</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.context.ContextEndpoint.analyze" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">analyze</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get contextual analysis for a search term.</p>
<p>Retrieves comprehensive contextual information including themes, entities,
tone analysis, and related queries for the specified search term.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search term to analyze</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (e.g., "24h", "7d", "30d")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="py_gdelt.endpoints.context.ContextResult">ContextResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ContextResult with themes, entities, and tone analysis</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 429 response</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 5xx response or connection error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On other HTTP errors or invalid JSON</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">analyze</span><span class="p">(</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ContextResult</span><span class="p">:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get contextual analysis for a search term.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Retrieves comprehensive contextual information including themes, entities,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    tone analysis, and related queries for the specified search term.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        query: Search term to analyze</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;)</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ContextResult with themes, entities, and tone analysis</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        RateLimitError: On 429 response</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Parse themes</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">themes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextTheme</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">ContextTheme</span><span class="p">(</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">theme</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;theme&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">score</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">),</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;themes&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="p">]</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="c1"># Parse entities</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>    <span class="n">entities</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextEntity</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="n">ContextEntity</span><span class="p">(</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="n">name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="n">entity_type</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;UNKNOWN&quot;</span><span class="p">),</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>        <span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entities&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="p">]</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="c1"># Parse tone</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">tone</span><span class="p">:</span> <span class="n">ContextTone</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">if</span> <span class="s2">&quot;tone&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;tone&quot;</span><span class="p">]</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">tone</span> <span class="o">=</span> <span class="n">ContextTone</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="n">average_tone</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="n">positive_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>            <span class="n">negative_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>            <span class="n">neutral_count</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;neutral&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="c1"># Parse related queries</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="n">related</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;related_queries&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="n">related_queries</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">related</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">related</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="p">[]</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">return</span> <span class="n">ContextResult</span><span class="p">(</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>        <span class="n">article_count</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;article_count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="n">themes</span><span class="o">=</span><span class="n">themes</span><span class="p">,</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">entities</span><span class="o">=</span><span class="n">entities</span><span class="p">,</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">tone</span><span class="o">=</span><span class="n">tone</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>        <span class="n">related_queries</span><span class="o">=</span><span class="n">related_queries</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.context.ContextEndpoint.get_themes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_themes</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get top themes for a search term.</p>
<p>Convenience method that returns just themes sorted by count.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search term</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max themes to return</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="py_gdelt.endpoints.context.ContextTheme">ContextTheme</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of top themes sorted by count (descending)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 429 response</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 5xx response or connection error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On other HTTP errors or invalid JSON</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_themes</span><span class="p">(</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextTheme</span><span class="p">]:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get top themes for a search term.</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">    Convenience method that returns just themes sorted by count.</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        query: Search term</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        timespan: Time range</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">        limit: Max themes to return</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        List of top themes sorted by count (descending)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        RateLimitError: On 429 response</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">sorted_themes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">themes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">return</span> <span class="n">sorted_themes</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.context.ContextEndpoint.get_entities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entities</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">entity_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get top entities for a search term.</p>
<p>Convenience method that returns entities, optionally filtered by type
and sorted by count.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search term</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>entity_type</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by type (PERSON, ORG, LOCATION)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>limit</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max entities to return</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="py_gdelt.endpoints.context.ContextEntity">ContextEntity</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of top entities sorted by count (descending)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 429 response</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On 5xx response or connection error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>On other HTTP errors or invalid JSON</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/context.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_entities</span><span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="n">entity_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">ContextEntity</span><span class="p">]:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get top entities for a search term.</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Convenience method that returns entities, optionally filtered by type</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    and sorted by count.</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        query: Search term</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">        timespan: Time range</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">        entity_type: Filter by type (PERSON, ORG, LOCATION)</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">        limit: Max entities to return</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a><span class="sd">        List of top entities sorted by count (descending)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a><span class="sd">        RateLimitError: On 429 response</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a><span class="sd">        APIUnavailableError: On 5xx response or connection error</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="sd">        APIError: On other HTTP errors or invalid JSON</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="n">entities</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">entities</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>    <span class="k">if</span> <span class="n">entity_type</span><span class="p">:</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="n">entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">entities</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">==</span> <span class="n">entity_type</span><span class="p">]</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="n">sorted_entities</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">entities</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">return</span> <span class="n">sorted_entities</span><span class="p">[:</span><span class="n">limit</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="tvendpoint">TVEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.tv.TVEndpoint" class="doc doc-heading">
            <code>TVEndpoint</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="py_gdelt.endpoints.base.BaseEndpoint">BaseEndpoint</span></code></p>



        <p>TV API endpoint for television news monitoring.</p>
<p>Searches transcripts from major US television networks including CNN,
Fox News, MSNBC, and others. Provides three query modes:
- Clip gallery: Individual video clips matching query
- Timeline: Time series of mention frequency
- Station chart: Breakdown by network</p>
<p>The endpoint handles date formatting, parameter building, and response
parsing automatically.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="py_gdelt.endpoints.tv.TVEndpoint.BASE_URL">BASE_URL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>API endpoint URL for TV queries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>async with TVEndpoint() as tv:
    clips = await tv.search("election", station="CNN")
    for clip in clips:
        print(f"{clip.show_name}: {clip.snippet}")</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="k">class</span><span class="w"> </span><span class="nc">TVEndpoint</span><span class="p">(</span><span class="n">BaseEndpoint</span><span class="p">):</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;TV API endpoint for television news monitoring.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">    Searches transcripts from major US television networks including CNN,</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Fox News, MSNBC, and others. Provides three query modes:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    - Clip gallery: Individual video clips matching query</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    - Timeline: Time series of mention frequency</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">    - Station chart: Breakdown by network</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">    The endpoint handles date formatting, parameter building, and response</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">    parsing automatically.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        BASE_URL: API endpoint URL for TV queries</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        async with TVEndpoint() as tv:</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            clips = await tv.search(&quot;election&quot;, station=&quot;CNN&quot;)</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            for clip in clips:</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">                print(f&quot;{clip.show_name}: {clip.snippet}&quot;)</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.gdeltproject.org/api/v2/tv/tv&quot;</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the request URL.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        TV API uses a fixed URL with query parameters.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            **kwargs: Unused, but required by BaseEndpoint interface.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            The base TV API URL.</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">TVFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build query parameters from TVFilter.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        Constructs query parameters for the TV API from a TVFilter object.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Handles both timespan and datetime range parameters, station/market</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        filtering, and output mode selection.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        Note: GDELT TV API requires station to be in the query string itself</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        (e.g., &quot;election station:CNN&quot;) rather than as a separate parameter.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">            query_filter: Validated TV filter object</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            Dictionary of query parameters ready for HTTP request</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="c1"># Build query string - GDELT TV API requires station in query</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>        <span class="n">query</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">query</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">station</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> station:</span><span class="si">{</span><span class="n">query_filter</span><span class="o">.</span><span class="n">station</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">market</span><span class="p">:</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> market:</span><span class="si">{</span><span class="n">query_filter</span><span class="o">.</span><span class="n">market</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="s2">&quot;maxrecords&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">query_filter</span><span class="o">.</span><span class="n">max_results</span><span class="p">),</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="p">}</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="c1"># Convert timespan to explicit datetime range (GDELT TV API TIMESPAN is unreliable)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="n">delta</span> <span class="o">=</span> <span class="n">_parse_timespan</span><span class="p">(</span><span class="n">query_filter</span><span class="o">.</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="n">start_dt</span> <span class="o">=</span> <span class="n">end_dt</span> <span class="o">-</span> <span class="n">delta</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="k">elif</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">start_datetime</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">start_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="k">if</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">end_datetime</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">query_filter</span><span class="o">.</span><span class="n">end_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="k">return</span> <span class="n">params</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">market</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Search TV transcripts for clips.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">        Searches television news transcripts and returns matching video clips</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        with metadata and text excerpts.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">            query: Search query (keywords, phrases, or boolean expressions)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">            start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">            end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">            station: Filter by station (CNN, FOXNEWS, MSNBC, etc.)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">            market: Filter by market (National, Philadelphia, etc.)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">            max_results: Maximum clips to return (1-250)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            List of TVClip objects matching the query</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            APIError: If the API returns an error</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">            RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">            APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">            clips = await tv.search(&quot;climate change&quot;, station=&quot;CNN&quot;, timespan=&quot;7d&quot;)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">market</span><span class="o">=</span><span class="n">market</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>            <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ClipGallery&quot;</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_clips</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query_clips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">TVFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Query for TV clips with a filter.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">        Lower-level method that accepts a TVFilter object for more control</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        over query parameters.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">            query_filter: TVFilter object with query parameters</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">            List of TVClip objects</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">            APIError: If the API returns an error</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">            RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">            APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ClipGallery&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="n">clips</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>            <span class="n">TVClip</span><span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>                <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                <span class="n">show_name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">),</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>                <span class="n">clip_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>                <span class="n">preview_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">),</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>                <span class="n">date</span><span class="o">=</span><span class="n">try_parse_gdelt_datetime</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>                <span class="n">duration_seconds</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">),</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>                <span class="n">snippet</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snippet&quot;</span><span class="p">),</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>            <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clips&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="p">]</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="k">return</span> <span class="n">clips</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">timeline</span><span class="p">(</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TVTimeline</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get timeline of TV mentions.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        Returns a time series showing when a topic was mentioned on television,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        useful for tracking coverage patterns over time.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            query: Search query</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            timespan: Time range (default: &quot;7d&quot;)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">            start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            station: Optional station filter</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            TVTimeline with time series data</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">            APIError: If the API returns an error</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">            timeline = await tv.timeline(&quot;election&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            for point in timeline.points:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">                print(f&quot;{point.date}: {point.count} mentions&quot;)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">start_datetime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>            <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>            <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>            <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;TimelineVol&quot;</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>        <span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>        <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVTimelinePoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>            <span class="n">TVTimelinePoint</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                <span class="n">date</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">),</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>                <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeline&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>        <span class="p">]</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>        <span class="k">return</span> <span class="n">TVTimeline</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">station_chart</span><span class="p">(</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>        <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>        <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TVStationChart</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get station comparison chart.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        Shows which stations covered a topic the most, useful for understanding</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        which networks are focusing on particular stories.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">            query: Search query</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">            timespan: Time range (default: &quot;7d&quot;)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">            TVStationChart with station breakdown</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            APIError: If the API returns an error</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">            RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            chart = await tv.station_chart(&quot;healthcare&quot;)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">            for station in chart.stations:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">                print(f&quot;{station.station}: {station.percentage}%&quot;)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>            <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">start_datetime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>            <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;StationChart&quot;</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>        <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>        <span class="n">stations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVStationData</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>        <span class="k">if</span> <span class="s2">&quot;stations&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>            <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">])</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                <span class="n">count</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                <span class="n">stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                    <span class="n">TVStationData</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                        <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                        <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                        <span class="n">percentage</span><span class="o">=</span><span class="n">count</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                    <span class="p">),</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>        <span class="k">return</span> <span class="n">TVStationChart</span><span class="p">(</span><span class="n">stations</span><span class="o">=</span><span class="n">stations</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.tv.TVEndpoint.search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">market</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Search TV transcripts for clips.</p>
<p>Searches television news transcripts and returns matching video clips
with metadata and text excerpts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query (keywords, phrases, or boolean expressions)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (e.g., "24h", "7d", "30d")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>station</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by station (CNN, FOXNEWS, MSNBC, etc.)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>market</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by market (National, Philadelphia, etc.)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum clips to return (1-250)</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="py_gdelt.endpoints.tv.TVClip">TVClip</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of TVClip objects matching the query</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API returns an error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limit is exceeded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API is unavailable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>clips = await tv.search("climate change", station="CNN", timespan="7d")</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">market</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Search TV transcripts for clips.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    Searches television news transcripts and returns matching video clips</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">    with metadata and text excerpts.</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        query: Search query (keywords, phrases, or boolean expressions)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;, &quot;30d&quot;)</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        station: Filter by station (CNN, FOXNEWS, MSNBC, etc.)</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">        market: Filter by market (National, Philadelphia, etc.)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        max_results: Maximum clips to return (1-250)</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        List of TVClip objects matching the query</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        APIError: If the API returns an error</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a><span class="sd">        APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">        clips = await tv.search(&quot;climate change&quot;, station=&quot;CNN&quot;, timespan=&quot;7d&quot;)</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span><span class="p">,</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">market</span><span class="o">=</span><span class="n">market</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>        <span class="n">max_results</span><span class="o">=</span><span class="n">max_results</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ClipGallery&quot;</span><span class="p">,</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="p">)</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_clips</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.tv.TVEndpoint.query_clips" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_clips</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Query for TV clips with a filter.</p>
<p>Lower-level method that accepts a TVFilter object for more control
over query parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query_filter</code>
            </td>
            <td>
                  <code><span title="py_gdelt.filters.TVFilter">TVFilter</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TVFilter object with query parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="py_gdelt.endpoints.tv.TVClip">TVClip</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of TVClip objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API returns an error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limit is exceeded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API is unavailable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-266" name="__codelineno-0-266"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">query_clips</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_filter</span><span class="p">:</span> <span class="n">TVFilter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Query for TV clips with a filter.</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    Lower-level method that accepts a TVFilter object for more control</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">    over query parameters.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">        query_filter: TVFilter object with query parameters</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">        List of TVClip objects</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">        APIError: If the API returns an error</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">        RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a><span class="sd">        APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="n">params</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ClipGallery&quot;</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="n">clips</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="n">TVClip</span><span class="p">(</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>            <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>            <span class="n">show_name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">),</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>            <span class="n">clip_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>            <span class="n">preview_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">),</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>            <span class="n">date</span><span class="o">=</span><span class="n">try_parse_gdelt_datetime</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">),</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>            <span class="n">snippet</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snippet&quot;</span><span class="p">),</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clips&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="p">]</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="k">return</span> <span class="n">clips</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.tv.TVEndpoint.timeline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">timeline</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="s1">&#39;7d&#39;</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get timeline of TV mentions.</p>
<p>Returns a time series showing when a topic was mentioned on television,
useful for tracking coverage patterns over time.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (default: "7d")</p>
              </div>
            </td>
            <td>
                  <code>&#39;7d&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>station</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional station filter</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="py_gdelt.endpoints.tv.TVTimeline">TVTimeline</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TVTimeline with time series data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API returns an error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limit is exceeded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API is unavailable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>timeline = await tv.timeline("election", timespan="30d")
for point in timeline.points:
    print(f"{point.date}: {point.count} mentions")</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">timeline</span><span class="p">(</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>    <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>    <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>    <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TVTimeline</span><span class="p">:</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get timeline of TV mentions.</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    Returns a time series showing when a topic was mentioned on television,</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">    useful for tracking coverage patterns over time.</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        query: Search query</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        timespan: Time range (default: &quot;7d&quot;)</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        station: Optional station filter</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        TVTimeline with time series data</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        APIError: If the API returns an error</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        timeline = await tv.timeline(&quot;election&quot;, timespan=&quot;30d&quot;)</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        for point in timeline.points:</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">            print(f&quot;{point.date}: {point.count} mentions&quot;)</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">start_datetime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a>        <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;TimelineVol&quot;</span><span class="p">,</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>    <span class="p">)</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">points</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVTimelinePoint</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>        <span class="n">TVTimelinePoint</span><span class="p">(</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>            <span class="n">date</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>            <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">),</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>            <span class="n">count</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>        <span class="p">)</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeline&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>    <span class="p">]</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>    <span class="k">return</span> <span class="n">TVTimeline</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.tv.TVEndpoint.station_chart" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">station_chart</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="s1">&#39;7d&#39;</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get station comparison chart.</p>
<p>Shows which stations covered a topic the most, useful for understanding
which networks are focusing on particular stories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (default: "7d")</p>
              </div>
            </td>
            <td>
                  <code>&#39;7d&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="py_gdelt.endpoints.tv.TVStationChart">TVStationChart</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TVStationChart with station breakdown</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API returns an error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limit is exceeded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API is unavailable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>chart = await tv.station_chart("healthcare")
for station in chart.stations:
    print(f"{station.station}: {station.percentage}%")</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">station_chart</span><span class="p">(</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;7d&quot;</span><span class="p">,</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a>    <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>    <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TVStationChart</span><span class="p">:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Get station comparison chart.</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">    Shows which stations covered a topic the most, useful for understanding</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    which networks are focusing on particular stories.</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        query: Search query</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        timespan: Time range (default: &quot;7d&quot;)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        TVStationChart with station breakdown</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        APIError: If the API returns an error</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        chart = await tv.station_chart(&quot;healthcare&quot;)</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        for station in chart.stations:</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            print(f&quot;{station.station}: {station.percentage}%&quot;)</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>    <span class="n">query_filter</span> <span class="o">=</span> <span class="n">TVFilter</span><span class="p">(</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>        <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="n">timespan</span><span class="o">=</span><span class="n">timespan</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">start_datetime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="n">start_datetime</span><span class="o">=</span><span class="n">start_datetime</span><span class="p">,</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>        <span class="n">end_datetime</span><span class="o">=</span><span class="n">end_datetime</span><span class="p">,</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;StationChart&quot;</span><span class="p">,</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="p">)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_params</span><span class="p">(</span><span class="n">query_filter</span><span class="p">)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>    <span class="n">stations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVStationData</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="k">if</span> <span class="s2">&quot;stations&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">])</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">count</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="n">TVStationData</span><span class="p">(</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                    <span class="n">count</span><span class="o">=</span><span class="n">count</span><span class="p">,</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                    <span class="n">percentage</span><span class="o">=</span><span class="n">count</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                <span class="p">),</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>            <span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="k">return</span> <span class="n">TVStationChart</span><span class="p">(</span><span class="n">stations</span><span class="o">=</span><span class="n">stations</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="tvaiendpoint">TVAIEndpoint</h3>


<div class="doc doc-object doc-class">



<h3 id="py_gdelt.endpoints.tv.TVAIEndpoint" class="doc doc-heading">
            <code>TVAIEndpoint</code>


</h3>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="py_gdelt.endpoints.base.BaseEndpoint">BaseEndpoint</span></code></p>



        <p>TVAI API endpoint for AI-enhanced TV analysis.</p>
<p>Similar to TVEndpoint but uses AI-powered features for enhanced analysis.
Uses the same data models and similar interface as TVEndpoint.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="py_gdelt.endpoints.tv.TVAIEndpoint.BASE_URL">BASE_URL</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>API endpoint URL for TVAI queries</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>async with TVAIEndpoint() as tvai:
    clips = await tvai.search("artificial intelligence")</p>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="k">class</span><span class="w"> </span><span class="nc">TVAIEndpoint</span><span class="p">(</span><span class="n">BaseEndpoint</span><span class="p">):</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;TVAI API endpoint for AI-enhanced TV analysis.</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    Similar to TVEndpoint but uses AI-powered features for enhanced analysis.</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    Uses the same data models and similar interface as TVEndpoint.</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">    Attributes:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">        BASE_URL: API endpoint URL for TVAI queries</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">        async with TVAIEndpoint() as tvai:</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">            clips = await tvai.search(&quot;artificial intelligence&quot;)</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.gdeltproject.org/api/v2/tvai/tvai&quot;</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the request URL.</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">        TVAI API uses a fixed URL with query parameters.</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            **kwargs: Unused, but required by BaseEndpoint interface.</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">            The base TVAI API URL.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">BASE_URL</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Search using AI-enhanced analysis.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">        Searches television transcripts using AI-powered analysis for potentially</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        better semantic matching and relevance.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">            query: Search query</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">            timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">            start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">            end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">            station: Filter by station</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">            max_results: Maximum clips to return (1-250)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">            List of TVClip objects</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">            APIError: If the API returns an error</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">            RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">            APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">        Example:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            clips = await tvai.search(&quot;machine learning&quot;, timespan=&quot;7d&quot;)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="c1"># Build query string - GDELT TV API requires station in query</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">query_str</span> <span class="o">=</span> <span class="n">query</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="k">if</span> <span class="n">station</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>            <span class="n">query_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> station:</span><span class="si">{</span><span class="n">station</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query_str</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;ClipGallery&quot;</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="s2">&quot;maxrecords&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_results</span><span class="p">),</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="p">}</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="c1"># Use explicit datetime range if provided, otherwise convert timespan</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>        <span class="k">if</span> <span class="n">start_datetime</span><span class="p">:</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>            <span class="k">if</span> <span class="n">end_datetime</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="k">elif</span> <span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">delta</span> <span class="o">=</span> <span class="n">_parse_timespan</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>                <span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>                <span class="n">start_dt</span> <span class="o">=</span> <span class="n">end_dt</span> <span class="o">-</span> <span class="n">delta</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>        <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="n">clips</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>            <span class="n">TVClip</span><span class="p">(</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>                <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>                <span class="n">show_name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">),</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>                <span class="n">clip_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>                <span class="n">preview_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">),</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>                <span class="n">date</span><span class="o">=</span><span class="n">try_parse_gdelt_datetime</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>                <span class="n">duration_seconds</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">),</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>                <span class="n">snippet</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snippet&quot;</span><span class="p">),</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>            <span class="p">)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clips&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>        <span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="k">return</span> <span class="n">clips</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="py_gdelt.endpoints.tv.TVAIEndpoint.search" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">timespan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_results</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Search using AI-enhanced analysis.</p>
<p>Searches television transcripts using AI-powered analysis for potentially
better semantic matching and relevance.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Search query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timespan</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range (e.g., "24h", "7d")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_datetime</code>
            </td>
            <td>
                  <code><span title="datetime.datetime">datetime</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End of date range (alternative to timespan)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>station</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter by station</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_results</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum clips to return (1-250)</p>
              </div>
            </td>
            <td>
                  <code>250</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="py_gdelt.endpoints.tv.TVClip">TVClip</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of TVClip objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIError (py_gdelt.exceptions.APIError)" href="../exceptions/#py_gdelt.exceptions.APIError">APIError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API returns an error</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RateLimitError (py_gdelt.exceptions.RateLimitError)" href="../exceptions/#py_gdelt.exceptions.RateLimitError">RateLimitError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rate limit is exceeded</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="APIUnavailableError (py_gdelt.exceptions.APIUnavailableError)" href="../exceptions/#py_gdelt.exceptions.APIUnavailableError">APIUnavailableError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API is unavailable</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>clips = await tvai.search("machine learning", timespan="7d")</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/py_gdelt/endpoints/tv.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="n">start_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">end_datetime</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="n">station</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>    <span class="n">max_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]:</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Search using AI-enhanced analysis.</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    Searches television transcripts using AI-powered analysis for potentially</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">    better semantic matching and relevance.</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">        query: Search query</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        timespan: Time range (e.g., &quot;24h&quot;, &quot;7d&quot;)</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">        start_datetime: Start of date range (alternative to timespan)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        end_datetime: End of date range (alternative to timespan)</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">        station: Filter by station</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        max_results: Maximum clips to return (1-250)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">        List of TVClip objects</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        APIError: If the API returns an error</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        RateLimitError: If rate limit is exceeded</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        APIUnavailableError: If the API is unavailable</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    Example:</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">        clips = await tvai.search(&quot;machine learning&quot;, timespan=&quot;7d&quot;)</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>    <span class="c1"># Build query string - GDELT TV API requires station in query</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>    <span class="n">query_str</span> <span class="o">=</span> <span class="n">query</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="k">if</span> <span class="n">station</span><span class="p">:</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">query_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> station:</span><span class="si">{</span><span class="n">station</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">query_str</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;ClipGallery&quot;</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>        <span class="s2">&quot;maxrecords&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">max_results</span><span class="p">),</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="p">}</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>    <span class="c1"># Use explicit datetime range if provided, otherwise convert timespan</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>    <span class="k">if</span> <span class="n">start_datetime</span><span class="p">:</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>        <span class="k">if</span> <span class="n">end_datetime</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_datetime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>    <span class="k">elif</span> <span class="n">timespan</span><span class="p">:</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>        <span class="n">delta</span> <span class="o">=</span> <span class="n">_parse_timespan</span><span class="p">(</span><span class="n">timespan</span><span class="p">)</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="k">if</span> <span class="n">delta</span><span class="p">:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">end_dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">start_dt</span> <span class="o">=</span> <span class="n">end_dt</span> <span class="o">-</span> <span class="n">delta</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;STARTDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ENDDATETIME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">%H%M%S&quot;</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>    <span class="n">url</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">()</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="n">data</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_json</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">clips</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">TVClip</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="n">TVClip</span><span class="p">(</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>            <span class="n">station</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>            <span class="n">show_name</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show&quot;</span><span class="p">),</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>            <span class="n">clip_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>            <span class="n">preview_url</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;preview&quot;</span><span class="p">),</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>            <span class="n">date</span><span class="o">=</span><span class="n">try_parse_gdelt_datetime</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)),</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>            <span class="n">duration_seconds</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">),</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="n">snippet</span><span class="o">=</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;snippet&quot;</span><span class="p">),</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="p">)</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clips&quot;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="p">]</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="k">return</span> <span class="n">clips</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>